Database -> new connection->MYSQL(Connector/J driver)->next.....

DB conection

JDBC
===========================
..JDBC Connection pool
ProductgenericResource
productgeneric

===========================
new -> poolname ->res type -> javax.sql.datasource -> vender->Mysql
datasource class name=com.mysql.cj.jdbc.MysqlDataSource(if it shows error than only add)
Properties

password->shruti
url ->jdbc:mysql://localhost:3306/ejdatabase?useSSL=false
URL ->jdbc:mysql://localhost:3306/ejdatabase?useSSL=false
serverName ->localhost
driver ->com.mysql.jdbc.Driver
user ->root
driverClass ->com.mysql.jdbc.Driver
port ->3306


finish->ping

=======================================================


===========================
..JDBC Resources
===========================

new -> JNDI name:jdbc/itpool
Poolname -> select pool name
ok

==========================================in web.xml================================
<servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>*.xhtml</url-pattern>
    </servlet-mapping>

======================my web.xml=================================
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="4.0" xmlns="http://xmlns.jcp.org/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd">
    <context-param>
        <param-name>javax.faces.PROJECT_STAGE</param-name>
        <param-value>Development</param-value>
    </context-param>
    <servlet>
        <servlet-name>Faces Servlet</servlet-name>
        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>/faces/*</url-pattern>
    </servlet-mapping>
    <session-config>
        <session-timeout>
            30
        </session-timeout>
    </session-config>
    <welcome-file-list>
        <welcome-file>faces/index.xhtml</welcome-file>
    </welcome-file-list>
</web-app>

======================End my web.xml=================================
write in update in clientrest
Entity.json("")
****************************************************************************democheck*************************************************************************************


new -> webapplication ->
new -> PU -> check none radio button
           .....in design part must check that  first 3 colum shoud be 
              1.Persistance unitname=(name of pu)
              2.Persistance Provider=EclipsLink(JPA 2.1)(default)
              3.data source =jdbc/externalpool(pool name)

         .......in source of PU change following 2 lines
                <persistence-unit name="externalsolutionPU" transaction-type="JTA">
                 <jta-data-source>jdbc/externalpool</jta-data-source>

         ......    <properties/>


new->entity classes from db->package name ->entity

new->sessionbean->choose local checkbox->package -> ejb
-------------------------------------------------
productbeanLocal(code)
-------------------------------------------------
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ejb;

import entity.Product;
import java.util.Collection;
import javax.ejb.Local;

/**
 *
 * @author Admin
 */
@Local
public interface productbeanLocal {
    Collection<Product> getAllproduct();
}



-------------------------------------------------
productbean(code)
-------------------------------------------------

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ejb;

import entity.Product;
import java.util.Collection;
import javax.ejb.Stateless;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

/**
 *
 * @author Admin
 */
@Stateless
public class productbean implements productbeanLocal {
@PersistenceContext(unitName = "externalsolutionPU")
    EntityManager em;

    @Override
    public Collection<Product> getAllproduct() {
               return em.createNamedQuery("Product.findAll").getResultList();

    }

        

}

-------------------------------------------------
testsevlet
-------------------------------------------------

@WebServlet(name = "testsevlet", urlPatterns = {"/testsevlet"})
public class testsevlet extends HttpServlet {
    @EJB productbeanLocal pbl;

protected void processRequest(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType("text/html;charset=UTF-8");
        try ( PrintWriter out = response.getWriter()) {
            /* TODO output your page here. You may use following sample code. */
            out.println("<!DOCTYPE html>");
            out.println("<html>");
            out.println("<head>");
            out.println("<title>Servlet testsevlet</title>");            
            out.println("</head>");
            out.println("<body>");
             Collection<Product> pr = pbl.getAllproduct();
            
            for(Product c : pr)
            {
             out.println("<br/>pname : "+ c.getPname());
            }
            out.println("<h1>Servlet testsevlet at " + request.getContextPath() + "</h1>");
            out.println("</body>");
            out.println("</html>");
        }
    }


==========================================================EndDemo================================================

=========================================================CRUD Without REST=============================================

same steps :
next :
      new -> JSF Cdi bean-> scope -> application
            else(new ->other->javaserver faces->JSF manages bean->package name(Controller)->scope(session)->finish)
---------------------
CustomrerLocal.java
---------------------
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ejb;

import entity.Address;
import entity.Customer;
import entity.Subscription;
import java.util.Collection;
import javax.ejb.Local;

/**
 *
 * @author Radhika Maniya
 */
@Local
public interface customerLocal {
     // ====  Customer =========
    Collection<Customer> getAllCustomers();
     //==== Address =================
     
     void addAddresOfCustomer(String street, String city, String state, String zip, Integer custId);
     void updateAddresOfCustomer(Integer addressId,String street, String city, String state, String zip, Integer custId);
     void removeAddressOfCustomer(Integer addressId, Integer custId);
     Collection<Address> getAddresesOfCustomer(Integer custId);
     Collection<Address> getAddressesByCity(String city);
     Collection<Address> getAddressesByState(String state);
     Collection<Address> getAddressesByZip(String zip);
     Collection<Address> getAddresses(String city, String State);

     
     
}

---------------------
Cusomer.java
---------------------

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ejb;

import entity.Address;
import entity.Customer;
import java.util.Collection;
import java.util.Date;
import javax.ejb.Stateless;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

/**
 *
 * @author Radhika Maniya
 */
@Stateless
public class customer implements customerLocal {
 @PersistenceContext(unitName = "Jsf_MultipalTable_crudPU")
    EntityManager em;
    @Override
    public Collection<Customer> getAllCustomers() {
       return em.createNamedQuery("Customer.findAll").getResultList();
    }

    @Override
    public void addAddresOfCustomer(String street, String city, String state, String zip, Integer custId) {
Customer c = em.find(Customer.class, custId);
    Collection<Address> addresses = c.getAddressCollection();
    
    Address address = new Address();
    address.setStreet(street);
    address.setCity(city);
    address.setState(state);
    address.setZip(zip);
    address.setCustomerId(c); // Very Important
    
    addresses.add(address);
    c.setAddressCollection(addresses);
    
    em.persist(address);
    em.merge(c);
        }

    @Override
    public void updateAddresOfCustomer(Integer addressId, String street, String city, String state, String zip, Integer custId) {
         Address a=em.find(Address.class,addressId);
         Customer c = em.find(Customer.class, custId);
    
//         a.setAddressId(addressId);
         a.setState(state);
          a.setCity(city);
          a.setStreet(street);
          a.setZip(zip);
         a.setCustomerId(c);
         
       em.merge(a);
    }

    @Override
    public void removeAddressOfCustomer(Integer addressId, Integer custId) {
Customer c = em.find(Customer.class, custId);
    Address address = em.find(Address.class, addressId);
    
    Collection<Address> addresses = c.getAddressCollection();
    
    if(addresses.contains(address))
    {
        addresses.remove(address);
        c.setAddressCollection(addresses);
        em.remove(address);
        em.merge(c);
    }
        }

    @Override
    public Collection<Address> getAddresesOfCustomer(Integer custId) {
Customer c = em.find(Customer.class, custId);
    
   return c.getAddressCollection();
    }

    @Override
    public Collection<Address> getAddressesByCity(String city) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public Collection<Address> getAddressesByState(String state) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public Collection<Address> getAddressesByZip(String zip) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public Collection<Address> getAddresses(String city, String State) {
           return em.createNamedQuery("Address.findAll").getResultList();

    }

    // Add business logic below. (Right-click in editor and choose
    // "Insert Code > Add Business Method")
}

---------------------
ManagedBean.java
---------------------

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package customerAddress;

import ejb.customerLocal;
import entity.Address;
import entity.Customer;
import java.util.Collection;
import javax.annotation.PostConstruct;
import javax.ejb.EJB;
import javax.inject.Named;
import javax.enterprise.context.ApplicationScoped;
import javax.persistence.Basic;
import javax.persistence.Column;
import javax.persistence.JoinColumn;
import javax.persistence.ManyToOne;
import javax.validation.constraints.NotNull;
import javax.validation.constraints.Size;

/**
 *
 * @author Radhika Maniya
 */
@Named(value = "managedBean")
@ApplicationScoped
public class ManagedBean {

    @EJB
    private customerLocal customer;
    
    Customer c = new Customer();
    Address a = new Address();
    
    
            
    Collection<Customer> castomer;
    private int addressId;
    private int customerId;
    private String street;
    private String city;
    private String state;
    private String zip;

    public Customer getC() {
        return c;
    }

    public void setC(Customer c) {
        this.c = c;
    }

    public Address getA() {
        return a;
    }

    public void setA(Address a) {
        this.a = a;
    }

    public Collection<Customer> getCastomer() {
        return castomer;
    }

    public void setCastomer(Collection<Customer> castomer) {
        this.castomer = castomer;
    }

    public int getAddressId() {
        return addressId;
    }

    public void setAddressId(int addressId) {
        this.addressId = addressId;
    }

    public int getCustomerId() {
        return customerId;
    }

    public void setCustomerId(int customerId) {
        this.customerId = customerId;
    }

    public String getStreet() {
        return street;
    }

    public void setStreet(String street) {
        this.street = street;
    }

    public String getCity() {
        return city;
    }

    public void setCity(String city) {
        this.city = city;
    }

    public String getState() {
        return state;
    }

    public void setState(String state) {
        this.state = state;
    }

    public String getZip() {
        return zip;
    }

    public void setZip(String zip) {
        this.zip = zip;
    }

   
    /**
     * Creates a new instance of ManagedBean
     */
    public ManagedBean() {
       
    }
      @PostConstruct
    public void init(){
        castomer = customer.getAllCustomers();
    }
    public Collection<Address> ShowAddresses(){
           return customer.getAddresses(city, state);  
    }
    
    public String addAddress(){
        customer.addAddresOfCustomer(street, city, state, zip, customerId);
        return "index";
    }
    
    public void deleteAddress(){
       customer.removeAddressOfCustomer(addressId, customerId);
    }
    
    public String edit(Address A)
    {
        this.addressId=A.getAddressId();
        this.state=A.getState();
        this.city=A.getCity();
        this.street=A.getStreet();
        this.zip=A.getZip();
        Customer c = A.getCustomerId();
        this.customerId =c.getCustomerID();
        this.a = new Address();
        return "editAddress";
        
    }
    
    public String edit()
    {
        this.customer.updateAddresOfCustomer(addressId, street, city, state, zip, customerId);
        return "index";
    }
    
    public void delete(Address add)
    {
        this.addressId = add.getAddressId();
        Customer c = add.getCustomerId();
        this.customerId = c.getCustomerID();
        this.customer.removeAddressOfCustomer(addressId, customerId);
    }
}


---------------------
editAddress.jsf
---------------------

<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        Hello from Facelets
        <h:form>
            state:<h:inputText value="#{managedBean.state}"></h:inputText><br/>
            city:<h:inputText value="#{managedBean.city}"></h:inputText><br/>
            street:<h:inputText value="#{managedBean.street}"></h:inputText><br/>
            zip:<h:inputText value="#{managedBean.zip}"></h:inputText><br/>
           
            <h:selectOneMenu value="#{managedBean.customerId}">
                <f:selectItems value="#{managedBean.castomer}" var="c" itemValue="#{c.customerID}" itemLabel="#{c.firstName}">
                </f:selectItems>
            </h:selectOneMenu>
            <h:commandButton value="save" action="#{managedBean.edit()}"></h:commandButton>
        </h:form>
        

    </h:body>
</html>
---------------------
index.jsf
---------------------
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        Hello from Facelets<f:view>

 <h:link value="Add Mobile" outcome="insertAddress"></h:link>
            <h:form>
                <h1><h:outputText value="List"/></h1>
                <h:dataTable value="#{managedBean.ShowAddresses()}" var="item">
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="AddressId"/>
                        </f:facet>
                        <h:outputText value="#{item.addressId}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Street"/>
                        </f:facet>
                        <h:outputText value="#{item.street}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="City"/>
                        </f:facet>
                        <h:outputText value="#{item.city}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="State"/>
                        </f:facet>
                        <h:outputText value="#{item.state}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Zip"/>
                        </f:facet>
                        <h:outputText value="#{item.zip}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="CustomerId"/>
                        </f:facet>
                        <h:outputText value="#{item.customerId.firstName}"/>
                    </h:column>
                    <h:column>
                    <f:facet name="header">Option</f:facet>
                    <h:commandLink action="#{managedBean.delete(item)}" value="Delete"></h:commandLink>
                </h:column>
                <h:column>
                    <f:facet name="header">Option</f:facet>
                    <h:commandLink action="#{managedBean.edit(item)}" value="Edit"></h:commandLink>
                </h:column>
                </h:dataTable>
            </h:form>
        </f:view>

    </h:body>
</html>

---------------------
insertAddress.jsf

---------------------
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
          <h:head>
        <title>Facelet Title</title>
           </h:head>
    <h:body>

<h:form>
            state:<h:inputText value="#{managedBean.state}"></h:inputText><br/>
            city:<h:inputText value="#{managedBean.city}"></h:inputText><br/>
            street:<h:inputText value="#{managedBean.street}"></h:inputText><br/>
            zip:<h:inputText value="#{managedBean.zip}"></h:inputText><br/>
           
            <h:selectOneMenu value="#{managedBean.customerId}">
                <f:selectItems value="#{managedBean.castomer}" var="c" itemValue="#{c.customerID}" itemLabel="#{c.firstName}">
                </f:selectItems>
            </h:selectOneMenu>
            <h:commandButton value="save" action="#{managedBean.addAddress()}"></h:commandButton>
        </h:form>
    
    </h:body>
</html>


=========================================================End CRUD Without REST=============================================

=========================================================Start CRUD With REST(sweta)=============================================
------------------------------
Cdi ben(Product.java)
------------------------------
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package Controller;

import javax.inject.Named;
import javax.enterprise.context.ApplicationScoped;

import client.ProductClient;
import entity.Brandtb;
import entity.Categorytb;
import entity.Producttb;
import java.util.Collection;
import javax.annotation.PostConstruct;
import javax.inject.Named;
import javax.enterprise.context.ApplicationScoped;
import javax.ws.rs.core.GenericType;
import javax.ws.rs.core.Response;

/**
 *
 * @author De
 */
@Named(value = "product")
@ApplicationScoped
public class Product {

    ProductClient productclient = new ProductClient();
    private Response res;
    private GenericType<Collection<Producttb>> productgeneric;
    private GenericType<Collection<Categorytb>> categorygeneric;
    private GenericType<Collection<Brandtb>> brandgeneric;
    
    Producttb producttb = new Producttb();
    
    private String pid,name,price,bid,cid;
    Collection<Categorytb> categorylist;
    Collection<Brandtb> brandlist;

    public Producttb getProducttb() {
        return producttb;
    }

    public void setProducttb(Producttb producttb) {
        this.producttb = producttb;
    }

    
    public String getPid() {
        return pid;
    }

    public void setPid(String pid) {
        this.pid = pid;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getPrice() {
        return price;
    }

    public void setPrice(String price) {
        this.price = price;
    }

    public String getBid() {
        return bid;
    }

    public void setBid(String bid) {
        this.bid = bid;
    }

    public String getCid() {
        return cid;
    }

    public void setCid(String cid) {
        this.cid = cid;
    }

    public Collection<Categorytb> getCategorylist() {
        return categorylist;
    }

    public void setCategorylist(Collection<Categorytb> categorylist) {
        this.categorylist = categorylist;
    }

    public Collection<Brandtb> getBrandlist() {
        return brandlist;
    }

    public void setBrandlist(Collection<Brandtb> brandlist) {
        this.brandlist = brandlist;
    }
    
    public Product() {
    }
    
    @PostConstruct
    public void init(){
       categorygeneric = new GenericType<Collection<Categorytb>>(){};
       res = productclient.getAllCategory(Response.class);
       this.categorylist = res.readEntity(categorygeneric);
       
       brandgeneric = new GenericType<Collection<Brandtb>>(){};
       res = productclient.getAllBrand(Response.class);
       this.brandlist = res.readEntity(brandgeneric);
    }
    
    public Collection<Producttb> findAll(){
            productgeneric = new GenericType<Collection<Producttb>>(){};
            res = productclient.getAllProducts(Response.class);
            Collection<Producttb> product = res.readEntity(productgeneric);
            return product;
    }
    
    public String add(){
        productclient.addProduct(name, price, bid, cid);
        this.producttb = new Producttb();
        return "display";
    }
    
    public void delete(Producttb p){
        this.pid = p.getPid().toString();
        Categorytb c = p.getCid();
        this.cid = c.getCid().toString();
        Brandtb b = p.getBid();
        this.bid = b.getBid().toString();
        productclient.removeProduct(pid, bid, cid);
    }
    
    public String edit(Producttb p){
        this.pid = p.getPid().toString();
        Categorytb c = p.getCid();
        this.cid = c.getCid().toString();
        Brandtb b = p.getBid();
        this.bid = b.getBid().toString();
        this.name = p.getPname();
        //this.price = p.getPrice();
        return "edit";
    }
    
    public String edit(){
        productclient.updateProduct(pid, name, price, bid, cid);
        this.producttb = new Producttb();
        return "display";
    }

}

------------------------------
Client(PAckage)ProductClient(Restful Java Client)
------------------------------
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package client;

import javax.ws.rs.ClientErrorException;
import javax.ws.rs.client.Client;
import javax.ws.rs.client.Entity;
import javax.ws.rs.client.WebTarget;

/**
 * Jersey REST client generated for REST resource:ProductgenericResource
 * [productgeneric]<br>
 * USAGE:
 * <pre>
 *        ProductClient client = new ProductClient();
 *        Object response = client.XXX(...);
 *        // do whatever with response
 *        client.close();
 * </pre>
 *
 * @author De
 */
public class ProductClient {

    private WebTarget webTarget;
    private Client client;
    private static final String BASE_URI = "http://localhost:8080/ProductData/webresources";

    public ProductClient() {
        client = javax.ws.rs.client.ClientBuilder.newClient();
        webTarget = client.target(BASE_URI).path("productgeneric");
    }

    public <T> T getAllProducts(Class<T> responseType) throws ClientErrorException {
        WebTarget resource = webTarget;
        return resource.request(javax.ws.rs.core.MediaType.APPLICATION_XML).get(responseType);
    }

    public <T> T getAllBrand(Class<T> responseType) throws ClientErrorException {
        WebTarget resource = webTarget;
        resource = resource.path("getAllBrand");
        return resource.request(javax.ws.rs.core.MediaType.APPLICATION_XML).get(responseType);
    }

    public void removeProduct(String pid, String bid, String cid) throws ClientErrorException {
        webTarget.path(java.text.MessageFormat.format("removeProduct/{0}/{1}/{2}", new Object[]{pid, bid, cid})).request().delete();
    }

    public void addProduct(String name, String price, String bid, String cid) throws ClientErrorException {
        webTarget.path(java.text.MessageFormat.format("addProduct/{0}/{1}/{2}/{3}", new Object[]{name, price, bid, cid})).request().post(null);
    }

    public void updateProduct(String pid, String name, String price, String bid, String cid) throws ClientErrorException {
        webTarget.path(java.text.MessageFormat.format("updateProduct/{0}/{1}/{2}/{3}/{4}", new Object[]{pid, name, price, bid, cid})).request().put(Entity.json(""));
    }

    public <T> T getProductByName(Class<T> responseType, String name) throws ClientErrorException {
        WebTarget resource = webTarget;
        resource = resource.path(java.text.MessageFormat.format("getProductByName/{0}", new Object[]{name}));
        return resource.request(javax.ws.rs.core.MediaType.APPLICATION_XML).get(responseType);
    }

    public <T> T getAllCategory(Class<T> responseType) throws ClientErrorException {
        WebTarget resource = webTarget;
        resource = resource.path("getAllCategory");
        return resource.request(javax.ws.rs.core.MediaType.APPLICATION_XML).get(responseType);
    }

    public void close() {
        client.close();
    }
    
}
------------------------------
ejb(Package)DataBeanLocal.java
------------------------------
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ejb;

import entity.Brandtb;
import entity.Categorytb;
import entity.Producttb;
import java.util.Collection;
import javax.ejb.Local;

/**
 *
 * @author De
 */
@Local
public interface DataBeanLocal {
    
    Collection<Categorytb> getAllCategory();
    Collection<Brandtb> getAllBrand();
        Collection<Producttb> getAllProducts();
        void addProduct(String name,int price,int bid,int cid);
        void updateProduct(int pid,String name,int price,int bid,int cid);
        void removeProduct(int pid,int bid,int cid);
        Collection<Producttb> getProductByName(String name);
}


------------------------------
ejb(Package)DataBean.java
------------------------------
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ejb;

import entity.Brandtb;
import entity.Categorytb;
import entity.Producttb;
import java.util.Collection;
import javax.ejb.Stateless;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

/**
 *
 * @author De
 */
@Stateless
public class DataBean implements DataBeanLocal {
   @PersistenceContext(unitName="ProductDataPU")
    EntityManager em;
    
    @Override
    public Collection<Producttb> getAllProducts() {
        return em.createNamedQuery("Producttb.findAll").getResultList();
    }

    @Override
    public void addProduct(String name, int price, int bid, int cid) {
        Brandtb b = em.find(Brandtb.class, bid);
        Categorytb c = em.find(Categorytb.class, cid);
        Producttb p = new Producttb();
        
        p.setPname(name);
        p.setPrice(price);
        p.setBid(b);
        p.setCid(c);
        
        em.persist(p);
        
        Collection<Producttb> brand = b.getProducttbCollection();
        Collection<Producttb> category = c.getProducttbCollection();
        
        brand.add(p);
        b.setProducttbCollection(brand);
        em.merge(b);
        
        category.add(p);
        c.setProducttbCollection(category);
        em.merge(c);
        
    }

    @Override
    public void updateProduct(int pid, String name, int price, int bid, int cid) {
        Brandtb b = em.find(Brandtb.class, bid);
        Categorytb c = em.find(Categorytb.class, cid);
        Producttb p = em.find(Producttb.class,pid);
        
        p.setBid(b);
        p.setCid(c);
        p.setPname(name);
        p.setPrice(price);
        
        em.merge(p);
    }

    @Override
    public void removeProduct(int pid, int bid, int cid) {
        Brandtb b = em.find(Brandtb.class, bid);
        Categorytb c = em.find(Categorytb.class, cid);
        Producttb p = em.find(Producttb.class,pid);
        
        Collection<Producttb> brand = b.getProducttbCollection();
        Collection<Producttb> category = c.getProducttbCollection();
        
        if(brand.contains(p)){
            brand.remove(p);
            b.setProducttbCollection(brand);
            category.remove(p);
            c.setProducttbCollection(category);
            em.merge(b);
            em.merge(c);
            em.remove(p);
        }
    }

    @Override
    public Collection<Producttb> getProductByName(String name) {
        Collection<Producttb> products = em.createNamedQuery("Producttb.findByPname").setParameter("pname",name).
                getResultList();
        return products;
    }

    @Override
    public Collection<Categorytb> getAllCategory() {
        return em.createNamedQuery("Categorytb.findAll").getResultList();
    }

    @Override
    public Collection<Brandtb> getAllBrand() {
        return em.createNamedQuery("Brandtb.findAll").getResultList();
    }

}


------------------------------
rest(Package)ProductgenericResource(restfull web services from pattern)
------------------------------

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package rest;

import ejb.DataBeanLocal;
import entity.Brandtb;
import entity.Categorytb;
import entity.Producttb;
import java.util.Collection;
import javax.ejb.EJB;
import javax.ws.rs.core.Context;
import javax.ws.rs.core.UriInfo;
import javax.ws.rs.Consumes;
import javax.ws.rs.DELETE;
import javax.ws.rs.Produces;
import javax.ws.rs.GET;
import javax.ws.rs.POST;
import javax.ws.rs.Path;
import javax.ws.rs.PUT;
import javax.ws.rs.PathParam;
import javax.ws.rs.core.MediaType;

/**
 * REST Web Service
 *
 * @author De
 */
@Path("productgeneric")
public class ProductgenericResource {

    @EJB DataBeanLocal db;
    @Context
    private UriInfo context;

    /**
     * Creates a new instance of ProductgenericResource
     */
    public ProductgenericResource() {
    }
    
    @GET
    @Produces(MediaType.APPLICATION_XML)
    public Collection<Producttb> getAllProducts(){
        return db.getAllProducts();
     }
    
    @GET
    @Produces(MediaType.APPLICATION_XML)
    @Path("getAllCategory")
    public Collection<Categorytb> getAllCategory(){
        return db.getAllCategory();
    }
    
    @GET
    @Produces(MediaType.APPLICATION_XML)
    @Path("getAllBrand")
    public Collection<Brandtb> getAllBrand(){
        return db.getAllBrand();
    }
    
    @POST
    @Path("addProduct/{name}/{price}/{bid}/{cid}")
    public void addProduct(@PathParam("name")String name,@PathParam("price")int price,@PathParam("bid")int bid,@PathParam("cid")int cid){
        db.addProduct(name, price, bid, cid);
    }
    
    @PUT
    @Path("updateProduct/{pid}/{name}/{price}/{bid}/{cid}")
    public void updateProduct(@PathParam("pid")int pid,@PathParam("name")String name,@PathParam("price")int price,@PathParam("bid")int bid,@PathParam("cid")int cid){
        db.updateProduct(pid, name, price, bid, cid);
    }
    
    @DELETE
    @Path("removeProduct/{pid}/{bid}/{cid}")
    public void removeProduct(@PathParam("pid")int pid,@PathParam("bid")int bid,@PathParam("cid")int cid){
        db.removeProduct(pid, bid, cid);
    }
    
    @GET
    @Produces(MediaType.APPLICATION_XML)
    @Path("getProductByName/{name}")    
    public Collection<Producttb> getProductByName(@PathParam("name")String name){
        return db.getProductByName(name);
    }
   
    
    
}



-----------------------------------
Servlet
----------------------------------
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package servlets;

import client.ProductClient;
import entity.Producttb;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.Collection;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.ws.rs.core.GenericType;
import javax.ws.rs.core.Response;

/**
 *
 * @author De
 */
@WebServlet(name = "NewServlet", urlPatterns = {"/NewServlet"})
public class NewServlet extends HttpServlet {

     Response res;
    ProductClient productclient;
    Producttb product;
    GenericType<Collection<Producttb>> productgeneric;
    /**
     * Processes requests for both HTTP <code>GET</code> and <code>POST</code>
     * methods.
     *
     * @param request servlet request
     * @param response servlet response
     * @throws ServletException if a servlet-specific error occurs
     * @throws IOException if an I/O error occurs
     */
    protected void processRequest(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType("text/html;charset=UTF-8");
        try ( PrintWriter out = response.getWriter()) {
            /* TODO output your page here. You may use following sample code. */
            out.println("<!DOCTYPE html>");
            out.println("<html>");
            out.println("<head>");
            out.println("<title>Servlet NewServlet</title>");            
            out.println("</head>");
            out.println("<body>");
            
            productclient = new ProductClient();
            productgeneric = new GenericType<Collection<Producttb>>(){};
            //productclient.addProduct("rest","33", "1","1");
          //  productclient.removeProduct("4","2","2");
            res = productclient.getAllProducts(Response.class);
            Collection<Producttb> product = res.readEntity(productgeneric);
            for(Producttb p : product){
                out.println("Name " + p.getPname());
            }
     
            out.println("<h1>Servlet NewServlet at " + request.getContextPath() + "</h1>");
            out.println("</body>");
            out.println("</html>");
        }
    }

    // <editor-fold defaultstate="collapsed" desc="HttpServlet methods. Click on the + sign on the left to edit the code.">
    /**
     * Handles the HTTP <code>GET</code> method.
     *
     * @param request servlet request
     * @param response servlet response
     * @throws ServletException if a servlet-specific error occurs
     * @throws IOException if an I/O error occurs
     */
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        processRequest(request, response);
    }

    /**
     * Handles the HTTP <code>POST</code> method.
     *
     * @param request servlet request
     * @param response servlet response
     * @throws ServletException if a servlet-specific error occurs
     * @throws IOException if an I/O error occurs
     */
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        processRequest(request, response);
    }

    /**
     * Returns a short description of the servlet.
     *
     * @return a String containing servlet description
     */
    @Override
    public String getServletInfo() {
        return "Short description";
    }// </editor-fold>

}



--------------------------------Start jsf------------------------------
--------------
display.xhtml
--------------

<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        
       <h:form>
                <br/>
                <h:link value="Add Product" outcome="insert"></h:link>
                <br/><br/>
                <h:dataTable id="tb1" var="p" value="#{product.findAll()}" border="1" cellpadding="1" width="500" cellspacing="1">
           
            <h:column>
                <f:facet name="header">Name</f:facet>
                <h:outputText value="#{p.pname}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Price</f:facet>
                <h:outputText value="#{p.price}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Category</f:facet>
                <h:outputText value="#{p.cid.cname}"></h:outputText>
            </h:column>            
            <h:column>
                <f:facet name="header">Brand</f:facet>
                <h:outputText value="#{p.bid.bname}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Edit</f:facet>
                <h:commandLink value="Edit" action="#{product.edit(p)}"></h:commandLink>
            </h:column>
            <h:column>
                <f:facet name="header">Delete</f:facet>
                <h:commandLink value="Delete" action="#{product.delete(p)}" onclick="return confirm('Are you sure?')"></h:commandLink>
            </h:column>
             </h:dataTable>
            </h:form>
    </h:body>
</html>



--------------
edit.xhtml
--------------

<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
       <h:form>
          Name: <h:inputText value="#{product.name}" required="true" requiredMessage="Product Name is required"></h:inputText><br/>
<!--          Price: <h:inputText value="#{product.price}" required="true" requiredMessage="Product Price is required"></h:inputText><br/>-->
          Brand: <h:selectOneMenu value="#{product.bid}">
              <f:selectItems value="#{product.brandlist}" var="b" itemValue="#{b.bid}" itemLabel="#{b.bname}"></f:selectItems>
          </h:selectOneMenu><br/>
          Category: <h:selectOneMenu value="#{product.cid}">
              <f:selectItems value="#{product.categorylist}" var="c" itemValue="#{c.cid}" itemLabel="#{c.cname}"></f:selectItems>
                    </h:selectOneMenu><br/>
                    <h:commandButton action="#{product.edit()}" value="Save"></h:commandButton>    
        </h:form>
    </h:body>
</html>



--------------
insert.xhtml
--------------
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title> Title</title>
    </h:head>
    <h:body>
      <h:form>
          Name: <h:inputText value="#{product.name}" required="true" requiredMessage="Product Name is required"></h:inputText><br/>
          Price: <h:inputText value="#{product.price}" required="true" requiredMessage="Product Price is required"></h:inputText><br/>
          Brand: <h:selectOneMenu value="#{product.bid}">
              <f:selectItems value="#{product.brandlist}" var="b" itemValue="#{b.bid}" itemLabel="#{b.bname}"></f:selectItems>
          </h:selectOneMenu><br/>
          Category: <h:selectOneMenu value="#{product.cid}">
              <f:selectItems value="#{product.categorylist}" var="c" itemValue="#{c.cid}" itemLabel="#{c.cname}"></f:selectItems>
                    </h:selectOneMenu><br/>
          <h:commandButton action="#{product.add()}" value="Save"></h:commandButton>    
        </h:form>
    </h:body>
</html>


-------------------------------- End jsf------------------------------

=========================================================End CRUD With REST(sweta)=============================================

=========================================================Start CRUD With REST(search also)=============================================
new->pu
new->session bean(ejb)
new->enttity classes from db(entity)
new->JSF cdi bean(Controller)
new->others->service->Rest full web services from pattern(rest)
new->others->services->Restfull Java Client(client)
/faces/EmpRest/index.xhtml


folder structure

* webpages 
  -Emp(folder)
       .Edit.xhtml
       .Insert.xhtml   
       .Search.xhtml
       .display.xhtml
 
  -EmpRest(folder)
        .index.xhtml
       
  -WEB-INF(folder)     
      .Update.xhtml
       .Insert.xhtml   
       .Search.xhtml
       .Display.xhtml

* Source Packages
  -beans(folder)
       .EmpBean.java
       .EmpBeanLocal.java
  -client(folder)
       .EmpClient.java
  -entity(folder)
        department,employee,project
  -managedbeans(folder)
       .DepartmentBean.java
       .EmployeeBean.java
       .RestEmployeeBean.java
  -rest(folder)
       .ApplicationConfig.java
       .EmpResource.java

  -servlet(folder)


 ----------------------------
 .Edit.xhtml
 ----------------------------
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        <h:form>
            <h1><h:outputText value="Edit Employee" /></h1>
            <h:inputHidden value="#{employeeBean.empId}" />
            <h:panelGrid columns="2">
                
                <h:outputLabel value="First Name" for="fname"/>
                <h:inputText id="fname" value="#{employeeBean.fname}" required="true" requiredMessage="First name should not be empty!" />
            
                <h:outputLabel value="Last Name" for="lname"/>
                <h:inputText id="lname" value="#{employeeBean.lname}" required="true" requiredMessage="Last name should not be empty!" />
            
                <h:outputLabel value="Age" for="age"/>
                <h:inputText id="age" value="#{employeeBean.age}" required="true" requiredMessage="Age should not be empty!" />
            
                
                <h:outputLabel value="Salary" for="salary"/>
                <h:inputText id="salary" value="#{employeeBean.salary}" required="true" requiredMessage="Salary should not be empty!" />
            
                <h:outputLabel value="Department" for="deptId"/>
                <h:selectOneMenu id="deptId" value="#{employeeBean.deptId}">
                    <f:selectItems value="#{employeeBean.departments}" var="d" itemValue="#{d.deptId}" itemLabel="#{d.deptName}">
                        
                    </f:selectItems>
                </h:selectOneMenu>
                
                <h:commandButton action="#{employeeBean.edit()}" value="SAVE" />
            </h:panelGrid>
        </h:form>
    </h:body>
</html>


 ----------------------------
 .Insert.xhtml   
 ----------------------------
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        <h:form>
            <h1><h:outputText value="Add Employee" /></h1>
<!--            <h:panelGrid >-->
                <h:outputLabel value="First Name" for="fname"/>
                <h:inputText id="fname" value="#{employeeBean.fname}" required="true" requiredMessage="First name should not be empty!" />
                <h:message for="fname" style=" color: red"/>  
            <br/>
                <h:outputLabel value="Last Name" for="lname"/>
                <h:inputText id="lname" value="#{employeeBean.lname}" required="true" requiredMessage="Last name should not be empty!" />
                <h:message for="lname" style=" color: red"/>  
            <br/>
                <h:outputLabel value="Age" for="age"/>
                <h:inputText id="age" value="#{employeeBean.age}" required="true" requiredMessage="Age should not be empty!" />
                <h:message for="age" style=" color: red"/>  
            <br/>  
                <h:outputLabel value="Salary" for="salary"/>
                <h:inputText id="salary" value="#{employeeBean.salary}" required="true" requiredMessage="Salary should not be empty!" />
            <br/>
                <h:outputLabel value="Department" for="deptId"/>
                <h:selectOneMenu id="deptId" value="#{employeeBean.deptId}">
                    <f:selectItems value="#{employeeBean.departments}" var="d" itemValue="#{d.deptId}" itemLabel="#{d.deptName}">
                        
                    </f:selectItems>
                </h:selectOneMenu>
             <br/>   
                <h:commandButton action="#{employeeBean.addEmployee()}" value="ADD" />
            <!--</h:panelGrid>-->
        </h:form>
    </h:body>
</html>


 ----------------------------
.Search.xhtml
 ----------------------------
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        
        
        <h:form>
            <center>
                <h1>Search Employee Form</h1>
                
                <h:outputLabel value="Department :  " for="deptName" />
                
                <h:selectOneMenu id="deptName" value="#{employeeBean.deptName}">
                    <f:selectItem itemValue="All" itemLabel="All"></f:selectItem>
                    <f:selectItems var="d" value="#{employeeBean.departments}" itemValue="#{d.deptName}" itemLabel="#{d.deptName}">
                        
                    </f:selectItems>
                </h:selectOneMenu>
    
                <br/><br/>
                <h:outputLabel value="Minimum range for salary : " for="sal"/>
                <h:inputText value="#{employeeBean.salary}" />
                
                <br/><br/>
                <h:commandButton id="b1" value="Search" action="#{employeeBean.filterEmpList()}">
<!--                    <f:ajax event="click" execute="deptName" render="tb1" />-->
                </h:commandButton>
                
                <br/><br/>
                <h:dataTable id="tb1" var="e" border="2" value="#{employeeBean.filterEmpList()}" cellpadding="2" cellspacing="2" width="600">
                    <h:column>
                        <f:facet name="header">Name</f:facet>
                        <h:outputText value="#{e.fname} #{e.lname}"/>
                    </h:column>
                    
                    <h:column>
                        <f:facet name="header">Age</f:facet>
                        <h:outputText value="#{e.age}"/>
                    </h:column>
                    
                    <h:column>
                        <f:facet name="header">Salary</f:facet>
                        <h:outputText value="#{e.salary}"/>
                    </h:column>
                    
                    <h:column>
                        <f:facet name="header">Department</f:facet>
                        <h:outputText value="#{e.dept.deptName}"/>
                    </h:column>
                </h:dataTable>
            </center>
            
            
            
        </h:form>
        
        
    </h:body>
</html>


 ----------------------------
       .display.xhtml
 ----------------------------
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
     >
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        <center>
            <h:form>
                <br/>
                <h:link value="Add Employee" outcome="Insert"></h:link>
                
                <br/><br/>
                
                <h:selectManyCheckbox id="deptSel" value="#{employeeBean.deptNms}">
                    <f:ajax event="click" execute="deptSel" render="tb1" />
                    <f:selectItems value="#{employeeBean.departments}" var="d" itemValue="#{d.deptName}" itemLabel="#{d.deptName}">
                        
                    </f:selectItems>
                </h:selectManyCheckbox>
                
                <br/><br/>
        <h:dataTable id="tb1" var="e" value="#{employeeBean.findAll()}" border="1" cellpadding="1" width="500" cellspacing="1">
            <h:column>
                <f:facet name="header">Name</f:facet>
                <h:outputText value="#{e.fname} #{e.lname}"></h:outputText>
            </h:column>
            
            <h:column>
                <f:facet name="header">Age</f:facet>
                <h:outputText value="#{e.age}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Salary</f:facet>
                <h:outputText value="#{e.salary}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Department</f:facet>
                <h:outputText value="#{e.dept.deptName}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Edit</f:facet>
                <h:commandLink value="Edit" action="#{employeeBean.edit(e)}"></h:commandLink>
            </h:column>
            <h:column>
                <f:facet name="header">Delete</f:facet>
                <h:commandLink value="Delete" action="#{employeeBean.deleteEmp(e.empId)}" onclick="return confirm('Are you sure?')"></h:commandLink>
            </h:column>
        </h:dataTable>
            </h:form>
        </center>
    </h:body>
</html>




 ----------------------------
 .index.xhtml
 ----------------------------
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        <f:view>

            <h:form>
                
                <h:selectManyCheckbox id="rBox" value="#{reBean.deptNms}">
                <f:ajax event="click" execute="rBox" render="dtable" /><!-- comment -->
                <f:selectItems value="#{reBean.departments}" var="d" itemValue="#{d.deptName}" itemLabel="#{d.deptName}">
                    
                </f:selectItems>
            </h:selectManyCheckbox>
            <br/><br/>
                
                <h1><h:outputText value="List"/></h1>
                <h:dataTable id="dtable" value="#{reBean.findAll()}" var="item">
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="EmpId"/>
                        </f:facet>
                        <h:outputText value="#{item.empId}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Fname"/>
                        </f:facet>
                        <h:outputText value="#{item.fname}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Lname"/>
                        </f:facet>
                        <h:outputText value="#{item.lname}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Age"/>
                        </f:facet>
                        <h:outputText value="#{item.age}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Salary"/>
                        </f:facet>
                        <h:outputText value="#{item.salary}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Department"/>
                        </f:facet>
                        <h:outputText value="#{item.dept.deptName}"/>
                    </h:column>
                </h:dataTable>
            </h:form>
        </f:view>

    </h:body>
</html>



 ----------------------------
   .Update.xhtml
 ----------------------------
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        
        <h:form>
                <h1><h:outputText value="Edit" /></h1>
                <h:inputHidden id="deptId" value="#{departmentBean.deptId}" /><br/>
                Department Name:<h:inputText id="deptName" value="#{departmentBean.deptName}" /><br/>
                <h:commandButton action="#{departmentBean.edit()}" value="Save"/><br/>
        </h:form>
    </h:body>
</html>



 ----------------------------
       .Insert.xhtml   
 ----------------------------
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
         
         <h:form>
                <h1><h:outputText value="Create" /></h1>
                <h:panelGrid columns="2">
                    <h:outputLabel value="Department Name:" for="deptName" />
                    <h:inputText id="deptName" value="#{departmentBean.deptName}" title="Departemnt Name" required="true"
                                 requiredMessage="This field is required"  /><br/>
                <h:commandButton action="#{departmentBean.insertDepartment()}" id="inset" value="Save"/><br/>
                </h:panelGrid>
        </h:form>
    </h:body>
</html>




 ----------------------------
       .index.xhtml
 ----------------------------
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        Hello from Facelets
    </h:body>
</html>


 ----------------------------
       .Display.xhtml
 ----------------------------
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        
        <h:form>
          
            <h:link value="Add new Department" outcome="Insert"></h:link><br/>
        <h:dataTable var="d" value="#{departmentBean.findAll()}" border="1" cellpadding="2" cellspacing="2">
            <h:column>
                <f:facet name="header">Id</f:facet>
                <h:outputText value="#{d.deptId}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Name</f:facet>
                <h:outputText value="#{d.deptName}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Option</f:facet>
                <h:commandLink value="Delete" action="#{departmentBean.deleteDepartment(d.deptId)}" onclick="return confirm('Are you sure?')" ></h:commandLink>
            </h:column>
            <h:column>
                <f:facet name="header">Option</f:facet>
                <h:commandLink value="Edit" action="#{departmentBean.edit(d)}"></h:commandLink>
            </h:column>
        </h:dataTable>
        </h:form>        
        
    </h:body>
</html>


 ----------------------------
 .EmpBean.java
----------------------------
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package beans;

import entity.Department;
import entity.Employee;
import entity.Project;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collection;
import javax.ejb.Stateless;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

/**
 *
 * @author kruti
 */
@Stateless
public class EmpBean implements EmpBeanLocal {

    @PersistenceContext(unitName="EmpFinalMixPU")
    EntityManager em;

    @Override
    public void addDepartment(String deptName) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Department d=new Department(deptName);
        em.persist(d);
    
    }

    @Override
    public void updateDepartment(Integer deptId, String deptName) {
        
        Department d=(Department) em.find(Department.class,deptId);
        d.setDeptName(deptName);
        em.merge(d);
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public void deleteDepartment(Integer deptId) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Department d=(Department) em.find(Department.class,deptId);
        em.remove(d);
    }

    @Override
    public Collection<Department> getAllDepartments() {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        return em.createNamedQuery("Department.findAll").getResultList();
    }

    @Override
    public void addEmployee(String fname, String lname, int age, int salary, Integer deptId) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Employee e=new Employee(fname,lname,age,salary);
        Department d=(Department) em.find(Department.class,deptId);
        e.setDept(d);
        
        
        Collection<Employee> empCol=d.getEmployeeCollection();
        empCol.add(e);
        d.setEmployeeCollection(empCol);
        
        em.persist(e);
        em.merge(d);
    }
    

    @Override
    public void updateEmployee(Integer empId, String fname, String lname, int age, int salary, Integer deptId) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Employee e=(Employee) em.find(Employee.class,empId);
        
        Integer oldDept=e.getDept().getDeptId();
        
        e.setFname(fname);
        e.setLname(lname);
        e.setAge(age);
        e.setSalary(salary);
        
        Department d=(Department) em.find(Department.class,deptId);
        e.setDept(d);
        
        
        Collection<Employee> eCol;
        Collection<Employee> oeCol;
        if(oldDept!=d.getDeptId()){
            eCol=d.getEmployeeCollection();
            eCol.add(e);
            d.setEmployeeCollection(eCol);
            
            Department od=(Department) em.find(Department.class,oldDept);
            oeCol=od.getEmployeeCollection();
            oeCol.remove(e);
            od.setEmployeeCollection(oeCol);
            em.merge(od);
        }
        
        em.merge(e);
        em.merge(d);
    }

    @Override
    public void deleteEmployee(Integer empId) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Employee e=(Employee) em.find(Employee.class, empId);
        Department d=e.getDept();
        
        
        
        Collection eCol=d.getEmployeeCollection();
        eCol.remove(e);
        d.setEmployeeCollection(eCol);
        
        em.remove(e);
        em.merge(d);
    
    }

    @Override
    public Collection<Employee> getAllEmployees() {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        return em.createNamedQuery("Employee.findAll").getResultList();
    }

    @Override
    public void addProject(String projectName, int cost, String startDate) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Project p=new Project(projectName,cost,startDate);
        em.persist(p);
    }

    @Override
    public void updateProject(Integer projectId, String projectName, int cost, String startDate) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Project p=(Project) em.find(Project.class,projectId);
        p.setProjectName(projectName);
        p.setCost(cost);
        p.setStartDate(startDate);
        em.merge(p);
    }

    @Override
    public void deleteProject(Integer projectId) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Project p=(Project) em.find(Project.class,projectId);
        em.remove(p);
    }

    @Override
    public Collection<Project> getAllProjects() {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        return em.createNamedQuery("Project.findAll").getResultList();
    }

    @Override
    public void addEmployeesToProject(Integer projectId, Collection<Integer> empIds) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
        Project p=(Project) em.find(Project.class, projectId);
        
        //Check if employee already added ?
        
        Collection<Employee> eCol=p.getEmployeeCollection();
        
        for(Integer eId:empIds){
            
            Employee e=(Employee) em.find(Employee.class,eId);
            if(!eCol.contains(e)){
                
               
                eCol.add(e);
                p.setEmployeeCollection(eCol);
                
                Collection<Project> pCol=e.getProjectCollection();
                pCol.add(p);
                e.setProjectCollection(pCol);
                em.merge(p);
                
            }
        }
        
    }

    @Override
    public void removeEmployeesToProject(Integer projectId, Collection<Integer> empIds) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Project p=(Project) em.find(Project.class, projectId);
        
        //Check if employee already added ?
        
        Collection<Employee> eCol=p.getEmployeeCollection();
        for(Integer eId:empIds){
            
            Employee e=(Employee) em.find(Employee.class,eId);
            if(eCol.contains(e)){
                
                eCol.remove(e);
                p.setEmployeeCollection(eCol);
                
                Collection<Project> pCol=e.getProjectCollection();
                pCol.remove(p);
                e.setProjectCollection(pCol);
                em.merge(p);    //IMPORTANT
                
            }
        }
    
    }

    @Override
    public Collection<Project> getEmpProjects(Integer EmpId) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Employee e=(Employee) em.find(Employee.class, EmpId);
        return e.getProjectCollection();
    }

    @Override
    public Collection<Employee> getProjectEmps(Integer ProjectId) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Project p=(Project) em.find(Project.class, ProjectId);
        return p.getEmployeeCollection();
    }

    @Override
    public Collection<Employee> getEmpByDeptName(String deptName) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Collection<Department> depts=em.createNamedQuery("Department.findByDeptName")
                .setParameter("deptName", deptName)
                .getResultList();
        
        Collection<Employee> emps=new ArrayList<Employee>();
        
        for(Department d:depts){
            emps.addAll(d.getEmployeeCollection());
        }
        return emps;
    }
    
    @Override
    public Collection<Employee> getEmpByDeptNames(Collection<String> deptNames) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        
        Collection<Department> depts=em.createNamedQuery("Department.findByDeptNames")
                .setParameter("deptNames", deptNames)
                .getResultList();
        
        Collection<Employee> emps=new ArrayList<Employee>();
        
        for(Department d:depts){
            emps.addAll(d.getEmployeeCollection());
        }
        return emps;
    }

    @Override
    public Collection<Employee> getEmpByDeptAndSalary(String deptName, int salary) {
        Collection<Department> depts=em.createNamedQuery("Department.findByDeptName")
                .setParameter("deptName", deptName)
                .getResultList();
        
        Collection<Employee> emps=new ArrayList<Employee>();
        Collection<Employee> empsFinal=new ArrayList<Employee>();
        
        for(Department d:depts){
            emps.addAll(d.getEmployeeCollection());
        }
        
        for(Employee e:emps){
            if(e.getSalary()>=salary){
                empsFinal.add(e);
            }
        }
        
        return empsFinal;
    }

    @Override
    public Collection<Employee> getEmpBySalary(int salary) {
        return em.createNamedQuery("Employee.findBySalary").setParameter("salary", salary).getResultList();
    }

    @Override
    public Collection<Employee> getEmpByDeptId(Integer deptId) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Department d=(Department) em.find(Department.class, deptId);
        return d.getEmployeeCollection();
    }

    @Override
    public Collection<Project> getProjectByName(String projectName) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Collection<Project> pCol=em.createNamedQuery("Project.findByProjectName")
                .setParameter("projectName", projectName)
                .getResultList();
        
        return pCol;
    }

    @Override
    public Collection<Project> getProjectWithinCostRange(int startCost, int endCost) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        
        Collection<Project> pCol=em.createNamedQuery("Project.findByCostRange")
                .setParameter("startRange", startCost)
                .setParameter("endRange",endCost)
                .getResultList();
        
        return pCol;
    }
}

----------------------------
       .EmpBeanLocal.java
----------------------------
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package beans;

import entity.Department;
import entity.Employee;
import entity.Project;
import java.util.Collection;
import javax.ejb.Local;

/**
 *
 * @author kruti
 */
@Local
public interface EmpBeanLocal {
    
    //Department
    void addDepartment(String deptName);
    void updateDepartment(Integer deptId, String deptName);
    void deleteDepartment(Integer deptId);
    Collection<Department> getAllDepartments();
    
    
    //Employee
    void addEmployee(String fname, String lname, int age, int salary, Integer deptId);
    void updateEmployee(Integer empId, String fname, String lname, int age, int salary, Integer deptId);
    void deleteEmployee(Integer empId);
    Collection<Employee> getAllEmployees();
    
    //Project
    void addProject(String projectName, int cost, String startDate);
    void updateProject(Integer projectId,String projectName, int cost, String startDate);
    void deleteProject(Integer projectId);
    Collection<Project> getAllProjects();
    
    void addEmployeesToProject(Integer projectId,Collection<Integer> empIds);
    void removeEmployeesToProject(Integer projectId,Collection<Integer> empIds);
    
    //Searching methods
    
    Collection<Project> getEmpProjects(Integer EmpId);
    Collection<Employee> getProjectEmps(Integer ProjectId);
    Collection<Employee> getEmpByDeptName(String deptName);
    Collection<Employee> getEmpByDeptNames(Collection<String> deptNames);
    Collection<Employee> getEmpByDeptAndSalary(String deptName,int salary);
    Collection<Employee> getEmpBySalary(int salary);
    Collection<Employee> getEmpByDeptId(Integer deptId);
    Collection<Project> getProjectByName(String projectName);
    Collection<Project> getProjectWithinCostRange(int startCost,int endCost);
    
}

----------------------------
 .EmpClient.java
----------------------------
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package client;

import javax.ws.rs.ClientErrorException;
import javax.ws.rs.client.Client;
import javax.ws.rs.client.WebTarget;

/**
 * Jersey REST client generated for REST resource:EmpResource [rest]<br>
 * USAGE:
 * <pre>
 *        EmpClient client = new EmpClient();
 *        Object response = client.XXX(...);
 *        // do whatever with response
 *        client.close();
 * </pre>
 *
 * @author kruti
 */
public class EmpClient {

    private WebTarget webTarget;
    private Client client;
    private static final String BASE_URI = "http://localhost:8080/EmpFinalMix/webresources";

    public EmpClient() {
        client = javax.ws.rs.client.ClientBuilder.newClient();
        webTarget = client.target(BASE_URI).path("rest");
    }

    public <T> T getAllEmployees(Class<T> responseType) throws ClientErrorException {
        WebTarget resource = webTarget;
        resource = resource.path("getAllEmployees");
        return resource.request(javax.ws.rs.core.MediaType.APPLICATION_JSON).get(responseType);
    }
    
    public <T> T getEmpByDeptNames(Object requestEntity,Class<T> responseType) throws ClientErrorException {
        WebTarget resource = webTarget;
        resource = resource.path("getEmpByDeptNames");
        return resource.request(javax.ws.rs.core.MediaType.APPLICATION_JSON).post(javax.ws.rs.client.Entity.entity(requestEntity, javax.ws.rs.core.MediaType.APPLICATION_JSON),responseType);
    }

    public void close() {
        client.close();
    }
    
}

----------------------------
       .DepartmentBean.java
----------------------------
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package managedBeans;

import beans.EmpBeanLocal;
import entity.Department;
import java.util.Collection;
import java.util.List;
import javax.ejb.EJB;
import javax.inject.Named;
import javax.enterprise.context.ApplicationScoped;
import javax.faces.application.FacesMessage;
import javax.faces.component.UIComponent;
import javax.faces.component.UIInput;
import javax.faces.context.FacesContext;

/**
 *
 * @author kruti
 */
@Named(value = "departmentBean")
@ApplicationScoped
public class DepartmentBean {

    @EJB
    private EmpBeanLocal empBean;
    
    Department dept=new Department();
    private Integer deptId;
    private String deptName;

    /**
     * Creates a new instance of DepartmentBean
     */
    public DepartmentBean() {
    }

    public Integer getDeptId() {
        return deptId;
    }

    public void setDeptId(Integer deptId) {
        this.deptId = deptId;
    }

    public String getDeptName() {
        return deptName;
    }

    public void setDeptName(String deptName) {
        this.deptName = deptName;
    }
    
    //Validation functions
    
    public void validateAge(FacesContext context,UIComponent comp,Object value){
        
        String empAge=(String) value;
        
        if(empAge.length()>2 || empAge.length()<=1){
            
            ((UIInput)comp).setValid(false);
            
            FacesMessage message=new FacesMessage("Please enter valid age");
            context.addMessage(comp.getClientId(context), message);
        }
    }
    
    
    public List<Department> findAll(){
      //  return (List<Departmenttb>) dataBean.getAllDepartments();
      return (List<Department>) this.empBean.getAllDepartments();
    }
    public String insertDepartment()
    {
        empBean.addDepartment(deptName);
        return "Display";
        //Move to the "Display" Page!!
    }
    
    public void deleteDepartment(int deptid){
       empBean.deleteDepartment(deptid);
    }

    public String edit(Department d)
    {
        this.dept=d;
        this.deptId=d.getDeptId();
        this.deptName=d.getDeptName();
        return "Update";    
    }
    
    public String edit()
    {
        empBean.updateDepartment(deptId,deptName);
        return "Display";
        
    }
    
}

----------------------------
       .EmployeeBean.java
----------------------------
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package managedBeans;

import beans.EmpBeanLocal;
import entity.Department;
import entity.Employee;
import entity.Project;
import java.util.ArrayList;
import java.util.Collection;
import java.util.List;
import javax.annotation.PostConstruct;
import javax.ejb.EJB;
import javax.ejb.Init;
import javax.inject.Named;
import javax.enterprise.context.ApplicationScoped;
import javax.validation.constraints.Min;
import javax.validation.constraints.Size;

/**
 *
 * @author kruti
 */
@Named(value = "employeeBean")
@ApplicationScoped
public class EmployeeBean {

    ///URL Not changing after edit, it should be reflect in url like "Display.xhtml"
    @EJB
    private EmpBeanLocal empBean;

    Employee emp=new Employee();
    Department dept=new Department();
    
    private Integer empId;
    
    private String fname;
    private String lname;
    
    //@Size(max=2, message = "Age must contain 2 digit number")  
    @Min(18)
    private int age;
    private int salary;
    private Integer deptId;
    
    //private Department dept;
    private Collection<Department> departments;
    private Collection<Project> projectCollection;
    private Collection<String> deptNms;
    private String deptName;
    
    public EmployeeBean() {
    }

    @PostConstruct          //IMPORTANT
    public void init(){
        this.departments=empBean.getAllDepartments();
        this.deptNms=new ArrayList<String>();
        this.deptName="";
    }

    public String getDeptName() {
        return deptName;
    }

    public void setDeptName(String deptName) {
        this.deptName = deptName;
    }

    public Collection<String> getDeptNms() {
        return deptNms;
    }

    public void setDeptNms(Collection<String> deptNms) {
        this.deptNms = deptNms;
    }

    
    public Integer getEmpId() {
        return empId;
    }

    public void setEmpId(Integer empId) {
        this.empId = empId;
    }

    public String getFname() {
        return fname;
    }

    public void setFname(String fname) {
        this.fname = fname;
    }

    public String getLname() {
        return lname;
    }

    public void setLname(String lname) {
        this.lname = lname;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }

    public int getSalary() {
        return salary;
    }

    public void setSalary(int salary) {
        this.salary = salary;
    }

    public Integer getDeptId() {
        return deptId;
    }

    public void setDeptId(Integer deptId) {
        this.deptId = deptId;
    }

    public Collection<Project> getProjectCollection() {
        return projectCollection;
    }

    public void setProjectCollection(Collection<Project> projectCollection) {
        this.projectCollection = projectCollection;
    }

    public Department getDept() {
        return dept;
    }

    public void setDept(Department dept) {
        this.dept = dept;
    }
    
    public List<Employee> findAll(){
        
        if(deptNms.isEmpty()){
            
            return (List<Employee>) this.empBean.getAllEmployees();
        }else{
            
            return (List<Employee>) this.empBean.getEmpByDeptNames(deptNms);
        }
    
    }
    
    public List<Employee> filterEmpList(){
        System.out.println(deptName);
        
        if((deptName=="" && salary==0) || (deptName.equals("All")&& salary==0)){
            
            return (List<Employee>) this.empBean.getAllEmployees();
        }else if(deptName.equals("All")&& salary!=0){
            
            return (List<Employee>) this.empBean.getEmpBySalary(salary);
        }else{
            return (List<Employee>) this.empBean.getEmpByDeptAndSalary(deptName,salary);
        }
    }
    
    public String addEmployee(){
        
        empBean.addEmployee(fname, lname, age, salary, deptId);
        
        return "display";
    }
    
    public String edit(Employee e){
        this.emp=e;
        this.empId=e.getEmpId();
        this.dept=e.getDept();
        this.fname=e.getFname();
        this.lname=e.getLname();
        this.age=e.getAge();
        this.salary=e.getSalary();
        this.deptId=e.getDept().getDeptId();
        
        return "Edit";
    }

    public Collection<Department> getDepartments() {
        return departments;
    }

    public void setDepartments(Collection<Department> departments) {
        this.departments = departments;
    }
    
    
    
    public String edit(){
        
        empBean.updateEmployee(empId, fname, lname, age, salary, deptId);
        this.emp=null;
        this.empId=0;
        this.dept=null;
        this.fname="";
        this.lname="";
        this.age=0;
        this.salary=0;
        this.deptId=0;
        return "display";
    }
    
    public void deleteEmp(Integer id){
        empBean.deleteEmployee(id);
    }
}


----------------------------
       .RestEmployeeBean.java
----------------------------
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package managedBeans;

import beans.EmpBeanLocal;
import client.EmpClient;
import entity.Department;
import entity.Employee;
import entity.Project;
import java.util.ArrayList;
import java.util.Collection;
import java.util.List;
import javax.annotation.PostConstruct;
import javax.ejb.EJB;
import javax.inject.Named;
import javax.enterprise.context.ApplicationScoped;
import javax.validation.constraints.Min;
import javax.ws.rs.core.GenericType;
import javax.ws.rs.core.Response;

/**
 *
 * @author kruti
 */
@Named(value = "reBean")
@ApplicationScoped
public class RestEmployeeBean {

    @EJB EmpBeanLocal empBean;
    EmpClient ec;
    Response res;

    Employee emp=new Employee();
    Department dept=new Department();
    
    private Integer empId;
    
    private String fname;
    private String lname;
    
    //@Size(max=2, message = "Age must contain 2 digit number")  
    @Min(18)
    private int age;
    private int salary;
    private Integer deptId;
    
    //private Department dept;
    private Collection<Department> departments;
    private Collection<Project> projectCollection;
    private Collection<String> deptNms;
    private GenericType<Collection<Employee>> gEmps;
    private String deptName;
    
    public RestEmployeeBean() {
    }

    @PostConstruct          //IMPORTANT
    public void init(){
        ec=new EmpClient();
        this.departments=empBean.getAllDepartments();
        
        this.deptNms=new ArrayList<String>();
        this.deptName="";
        gEmps=new GenericType<Collection<Employee>>(){};
    }

    public String getDeptName() {
        return deptName;
    }

    public void setDeptName(String deptName) {
        this.deptName = deptName;
    }

    public Collection<String> getDeptNms() {
        return deptNms;
    }

    public void setDeptNms(Collection<String> deptNms) {
        this.deptNms = deptNms;
    }

    
    public Integer getEmpId() {
        return empId;
    }

    public void setEmpId(Integer empId) {
        this.empId = empId;
    }

    public String getFname() {
        return fname;
    }

    public void setFname(String fname) {
        this.fname = fname;
    }

    public String getLname() {
        return lname;
    }

    public void setLname(String lname) {
        this.lname = lname;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }

    public int getSalary() {
        return salary;
    }

    public void setSalary(int salary) {
        this.salary = salary;
    }

    public Integer getDeptId() {
        return deptId;
    }

    public void setDeptId(Integer deptId) {
        this.deptId = deptId;
    }

    public Collection<Project> getProjectCollection() {
        return projectCollection;
    }

    public void setProjectCollection(Collection<Project> projectCollection) {
        this.projectCollection = projectCollection;
    }

    public Department getDept() {
        return dept;
    }

    public void setDept(Department dept) {
        this.dept = dept;
    }
    
    public List<Employee> findAll(){
        
        if(deptNms.isEmpty()){
            res=ec.getAllEmployees(Response.class);
            return (List<Employee>) res.readEntity(gEmps);
            //return (List<Employee>) this.empBean.getAllEmployees();
        }else{
            res=ec.getEmpByDeptNames(deptNms,Response.class);
            return (List<Employee>) res.readEntity(gEmps);
            //return (List<Employee>) this.empBean.getEmpByDeptNames(deptNms);
        }
    
    }
    
    public List<Employee> filterEmpList(){
        System.out.println(deptName);
        
        if((deptName=="" && salary==0) || (deptName.equals("All")&& salary==0)){
            
            return (List<Employee>) this.empBean.getAllEmployees();
        }else if(deptName.equals("All")&& salary!=0){
            
            return (List<Employee>) this.empBean.getEmpBySalary(salary);
        }else{
            return (List<Employee>) this.empBean.getEmpByDeptAndSalary(deptName,salary);
        }
    }
    
    public String addEmployee(){
        
        empBean.addEmployee(fname, lname, age, salary, deptId);
        
        return "display";
    }
    
    public String edit(Employee e){
        this.emp=e;
        this.empId=e.getEmpId();
        this.dept=e.getDept();
        this.fname=e.getFname();
        this.lname=e.getLname();
        this.age=e.getAge();
        this.salary=e.getSalary();
        this.deptId=e.getDept().getDeptId();
        
        return "Edit";
    }

    public Collection<Department> getDepartments() {
        return departments;
    }

    public void setDepartments(Collection<Department> departments) {
        this.departments = departments;
    }
    
    
    
    public String edit(){
        
        empBean.updateEmployee(empId, fname, lname, age, salary, deptId);
        this.emp=null;
        this.empId=0;
        this.dept=null;
        this.fname="";
        this.lname="";
        this.age=0;
        this.salary=0;
        this.deptId=0;
        return "display";
    }
    
    public void deleteEmp(Integer id){
        empBean.deleteEmployee(id);
    }
    
}

----------------------------
  .ApplicationConfig.java
----------------------------
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package rest;

import java.util.Set;
import javax.ws.rs.core.Application;

/**
 *
 * @author kruti
 */
@javax.ws.rs.ApplicationPath("webresources")
public class ApplicationConfig extends Application {

    @Override
    public Set<Class<?>> getClasses() {
        Set<Class<?>> resources = new java.util.HashSet<>();
        addRestResourceClasses(resources);
        return resources;
    }

    /**
     * Do not modify addRestResourceClasses() method.
     * It is automatically populated with
     * all resources defined in the project.
     * If required, comment out calling this method in getClasses().
     */
    private void addRestResourceClasses(Set<Class<?>> resources) {
        resources.add(rest.EmpResource.class);
    }
    
}

----------------------------
       .EmpResource.java
----------------------------
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package rest;

import beans.EmpBeanLocal;
import entity.Department;
import entity.Employee;
import entity.Project;
import java.util.ArrayList;
import java.util.Collection;
import javax.ejb.EJB;
import javax.ws.rs.core.Context;
import javax.ws.rs.core.UriInfo;
import javax.ws.rs.Produces;
import javax.ws.rs.Consumes;
import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.PUT;
import javax.enterprise.context.RequestScoped;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.ws.rs.POST;
import javax.ws.rs.core.MediaType;

/**
 * REST Web Service
 *
 * @author kruti
 */
@Path("rest")
@RequestScoped
public class EmpResource {

    @Context
    private UriInfo context;

    /**
     * Creates a new instance of EmpResource
     */
    public EmpResource() {
    }

    @EJB EmpBeanLocal ebl;

    @Path("getAllEmployees")
    @GET
    @Produces(MediaType.APPLICATION_JSON)
    public Collection<Employee> getAllEmployees() {
        return ebl.getAllEmployees();
    }
   
    
    @Path("getEmpByDeptNames")
    @POST
    @Consumes(MediaType.APPLICATION_JSON)
    @Produces(MediaType.APPLICATION_JSON)
    public Collection<Employee> getEmpByDeptNames(Collection<String> deptNames) {
        
        
        return ebl.getEmpByDeptNames(deptNames);
    }

}


----------------------------
servlet
----------------------------
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package servlet;

import beans.EmpBeanLocal;
import entity.Department;
import java.io.IOException;
import java.io.PrintWriter;
import javax.ejb.EJB;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 *
 * @author kruti
 */
@WebServlet(name = "BeanServlet", urlPatterns = {"/BeanServlet"})
public class BeanServlet extends HttpServlet {

    @EJB EmpBeanLocal ebl;
    /**
     * Processes requests for both HTTP <code>GET</code> and <code>POST</code>
     * methods.
     *
     * @param request servlet request
     * @param response servlet response
     * @throws ServletException if a servlet-specific error occurs
     * @throws IOException if an I/O error occurs
     */
    protected void processRequest(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType("text/html;charset=UTF-8");
        try ( PrintWriter out = response.getWriter()) {
            /* TODO output your page here. You may use following sample code. */
            out.println("<!DOCTYPE html>");
            out.println("<html>");
            out.println("<head>");
            out.println("<title>Servlet BeanServlet</title>");            
            out.println("</head>");
            out.println("<body>");
           
            out.println("<h3>DeptID     DeptName</h3>");
            for(Department d:ebl.getAllDepartments()){
                out.println("<p>"+d.getDeptId()+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+d.getDeptName()+"</p>");
            }
            
            out.println("</body>");
            out.println("</html>");
        }
    }

    // <editor-fold defaultstate="collapsed" desc="HttpServlet methods. Click on the + sign on the left to edit the code.">
    /**
     * Handles the HTTP <code>GET</code> method.
     *
     * @param request servlet request
     * @param response servlet response
     * @throws ServletException if a servlet-specific error occurs
     * @throws IOException if an I/O error occurs
     */
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        processRequest(request, response);
    }

    /**
     * Handles the HTTP <code>POST</code> method.
     *
     * @param request servlet request
     * @param response servlet response
     * @throws ServletException if a servlet-specific error occurs
     * @throws IOException if an I/O error occurs
     */
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        processRequest(request, response);
    }

    /**
     * Returns a short description of the servlet.
     *
     * @return a String containing servlet description
     */
    @Override
    public String getServletInfo() {
        return "Short description";
    }// </editor-fold>

}

=========================================================End CRUD With REST(serch also)=============================================


************************************************************************search**************************************************

/entity/Department.java			(Add the named query)
========================================================

@NamedQuery(name = "Department.findByDeptNames", query = "SELECT d FROM Department d WHERE d.deptName IN :deptNames")

========================================================
/beans/EmpBean.java				(Add this function with code)
========================================================
@Override
    public Collection<Employee> getEmpByDeptNames(Collection<String> deptNames) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        
        Collection<Department> depts=em.createNamedQuery("Department.findByDeptNames")
                .setParameter("deptNames", deptNames)
                .getResultList();
        
        Collection<Employee> emps=new ArrayList<Employee>();
        
        for(Department d:depts){
            emps.addAll(d.getEmployeeCollection());
        }
        return emps;
    }

===============================================
/ManagedBean/EmployeeBean
===============================================

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package managedBeans;

import beans.EmpBeanLocal;
import entity.Department;
import entity.Employee;
import entity.Project;
import java.util.ArrayList;
import java.util.Collection;
import java.util.List;
import javax.annotation.PostConstruct;
import javax.ejb.EJB;
import javax.ejb.Init;
import javax.inject.Named;
import javax.enterprise.context.ApplicationScoped;
import javax.validation.constraints.Min;
import javax.validation.constraints.Size;

/**
 *
 * @author kruti
 */
@Named(value = "employeeBean")
@ApplicationScoped
public class EmployeeBean {

    ///URL Not changing after edit, it should be reflect in url like "Display.xhtml"
    @EJB
    private EmpBeanLocal empBean;

    Employee emp=new Employee();
    Department dept=new Department();
    
    private Integer empId;
    
    private String fname;
    private String lname;
    
    //@Size(max=2, message = "Age must contain 2 digit number")  
    @Min(18)
    private int age;
    private int salary;
    private Integer deptId;
    
    //private Department dept;
    private Collection<Department> departments;
    private Collection<Project> projectCollection;
    private Collection<String> deptNms;
    
    public EmployeeBean() {
    }

    @PostConstruct          //IMPORTANT
    public void init(){
        this.departments=empBean.getAllDepartments();
        this.deptNms=new ArrayList<String>();
    }

    public Collection<String> getDeptNms() {
        return deptNms;
    }

    public void setDeptNms(Collection<String> deptNms) {
        this.deptNms = deptNms;
    }

    
    public Integer getEmpId() {
        return empId;
    }

    public void setEmpId(Integer empId) {
        this.empId = empId;
    }

    public String getFname() {
        return fname;
    }

    public void setFname(String fname) {
        this.fname = fname;
    }

    public String getLname() {
        return lname;
    }

    public void setLname(String lname) {
        this.lname = lname;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }

    public int getSalary() {
        return salary;
    }

    public void setSalary(int salary) {
        this.salary = salary;
    }

    public Integer getDeptId() {
        return deptId;
    }

    public void setDeptId(Integer deptId) {
        this.deptId = deptId;
    }

    public Collection<Project> getProjectCollection() {
        return projectCollection;
    }

    public void setProjectCollection(Collection<Project> projectCollection) {
        this.projectCollection = projectCollection;
    }

    public Department getDept() {
        return dept;
    }

    public void setDept(Department dept) {
        this.dept = dept;
    }
    
    public List<Employee> findAll(){
        
        if(deptNms.isEmpty()){
            
            return (List<Employee>) this.empBean.getAllEmployees();
        }else{
            
            return (List<Employee>) this.empBean.getEmpByDeptNames(deptNms);
        }
    
    }
    
    public String addEmployee(){
        
        empBean.addEmployee(fname, lname, age, salary, deptId);
        
        return "display";
    }
    
    public String edit(Employee e){
        this.emp=e;
        this.empId=e.getEmpId();
        this.dept=e.getDept();
        this.fname=e.getFname();
        this.lname=e.getLname();
        this.age=e.getAge();
        this.salary=e.getSalary();
        this.deptId=e.getDept().getDeptId();
        
        return "Edit";
    }

    public Collection<Department> getDepartments() {
        return departments;
    }

    public void setDepartments(Collection<Department> departments) {
        this.departments = departments;
    }
    
    
    
    public String edit(){
        
        empBean.updateEmployee(empId, fname, lname, age, salary, deptId);
        this.emp=null;
        this.empId=0;
        this.dept=null;
        this.fname="";
        this.lname="";
        this.age=0;
        this.salary=0;
        this.deptId=0;
        return "display";
    }
    
    public void deleteEmp(Integer id){
        empBean.deleteEmployee(id);
    }
}

========================================================
display.xhtml
========================================================

<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
     >
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        <center>
            <h:form>
                <br/>
                <h:link value="Add Employee" outcome="Insert"></h:link>
                
                <br/><br/>
                
                <h:selectManyCheckbox id="deptSel" value="#{employeeBean.deptNms}">
                    <f:ajax event="click" execute="deptSel" render="tb1" />
                    <f:selectItems value="#{employeeBean.departments}" var="d" itemValue="#{d.deptName}" itemLabel="#{d.deptName}">
                        
                    </f:selectItems>
                </h:selectManyCheckbox>
                
                
                <br/><br/>
        <h:dataTable id="tb1" var="e" value="#{employeeBean.findAll()}" border="1" cellpadding="1" width="500" cellspacing="1">
            <h:column>
                <f:facet name="header">Name</f:facet>
                <h:outputText value="#{e.fname} #{e.lname}"></h:outputText>
            </h:column>
            
            <h:column>
                <f:facet name="header">Age</f:facet>
                <h:outputText value="#{e.age}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Salary</f:facet>
                <h:outputText value="#{e.salary}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Department</f:facet>
                <h:outputText value="#{e.dept.deptName}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Edit</f:facet>
                <h:commandLink value="Edit" action="#{employeeBean.edit(e)}"></h:commandLink>
            </h:column>
            <h:column>
                <f:facet name="header">Delete</f:facet>
                <h:commandLink value="Delete" action="#{employeeBean.deleteEmp(e.empId)}" onclick="return confirm('Are you sure?')"></h:commandLink>
            </h:column>
        </h:dataTable>
            </h:form>
        </center>
    </h:body>
</html>


************************************************************************End search**************************************************




***************************************************************Method with more than one foregin key****************************************************
----------------
beanlocal
-----------------

 Collection<Packages> getAllPackages();
      void addPackages(String PackageName,Integer CategoryID,Integer StateID,Integer NoOfDays,Integer NoOfNights,Integer PackageCharge, DateTime FromDate,DateTime ToDate,String Image1,String Image2,String Image3,String Image4,String ScheduleDescription);
      void updatePackages(Integer PackageID,String PackageName,Integer CategoryID,Integer StateID,Integer NoOfDays,Integer NoOfNights,Integer PackageCharge, DateTime FromDate,DateTime ToDate,String Image1,String Image2,String Image3,String Image4,String ScheduleDescription);
      void removePackages(Integer PackageID);
       Collection<Packages> SearchPacagesByName(String PackageName);
      Packages SearchPacagesById(Integer PackageID);
------------------------
bean.java
------------------------


    @Override
    public void addPackages(String PackageName, Integer CategoryID, Integer StateID, Integer NoOfDays, Integer NoOfNights, Integer PackageCharge, DateTime FromDate, DateTime ToDate, String Image1, String Image2, String Image3, String Image4, String ScheduleDescription) {
     Category c = em.find(Category.class, CategoryID);
     
//     System.out.println(c);
     State s=em.find(State.class,StateID);
     
     // !packagess.isEmpty() 
     
     if(c != null && s != null)
     {
        Collection<Packages> packagess = c.getPackagesCollection();
        Collection<Packages> packagess1 = s.getPackagesCollection();
     Packages packages = new Packages();
     packages.setPackageName(PackageName);
     packages.setCategoryID(c);
     packages.setStateID(s);
     packages.setNoOfDays(NoOfDays);
     packages.setNoOfNights(NoOfNights);
     packages.setPackageCharge(PackageCharge);
     //packages.setFromDate((Date) fromDate);  //new Date()
     packages.setFromDate(new Date());
     //packages.setToDate((Date) toDate);
     packages.setToDate(new Date());
     packages.setImage1(Image1);
     packages.setImage2(Image2);
     packages.setImage3(Image3);
     packages.setImage4(Image4);
     packages.setScheduleDescription(ScheduleDescription);
     packagess.add(packages);
     packagess1.add(packages);
        em.persist(packages);
        em.merge(c);
        em.merge(s);
     }
     
    
    // packages.setFromDate(fromDate);
     
    }


    @Override
    public void updatePackages(Integer PackageID, String PackageName, Integer CategoryID, Integer StateID, Integer NoOfDays, Integer NoOfNights, Integer PackageCharge, DateTime FromDate, DateTime ToDate, String Image1, String Image2, String Image3, String Image4, String ScheduleDescription) {
//        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
         Packages p= em.find(Packages.class,PackageID);
         
         Category c = em.find(Category.class, CategoryID);
         
         System.out.println(p);
         System.out.println(c);
         
         State s =em.find(State.class, StateID);
          System.out.println(s);
         p.setPackageName(PackageName);
         p.setCategoryID(c);
         p.setStateID(s);
         p.setNoOfDays(NoOfDays);
         p.setNoOfNights(NoOfNights);
         p.setPackageCharge(PackageCharge);
         p.setFromDate(new Date());
         p.setToDate(new Date());
         p.setImage1(Image1);
         p.setImage2(Image2);
         p.setImage3(Image3);
         p.setImage4(Image4);
         p.setScheduleDescription(ScheduleDescription);
         
         
                 
      
       em.merge(p);
    }

    @Override
    public void removePackages(Integer PackageID) {
         Packages p= em.find(Packages.class,PackageID);
         em.remove(p);
    
    }

    @Override
    public Collection<Packages> SearchPacagesByName(String PackageName) {
          Collection<Packages> packages = em.createNamedQuery("Packages.findByPackageName")
             .setParameter("packageName", PackageName)
             .getResultList();
     
     return packages;
    }

   
    @Override
    public Packages SearchPacagesById(Integer PackageID) {
        return em.find(Packages.class, PackageID);
    }



------------------------
servlet
----------------------
public class AdminServletFinal extends HttpServlet {
@EJB AdminBeanLocal pbl;



           //pbl.addPackages("second",1,3,3,3,30000,null ,null,"jkhjghj","hjkhk","hjvhjhj", "hgj","ghccghcgfcgf");
           // pbl.addPackages("first",1,2,2,3,300,null ,null,"jkhjghj","hjkhk","hjvhjhj", "hgj","ghccghcgfcgf");
           
           //pbl.updatePackages(1,"FIrstttt",1,3,2,30,10,null ,null,"jkhjghj","hjkhk","hjvhjhj", "hgj","ghccghcgfcgf");
           // pbl.removePackages(2);
            // Collection<Packages> packages = pbl.SearchPacagesByName("second");
             //for(Packages p : packages)
            // {
             // out.println("<br/>PackageName : "+ p.getPackageName() + " Charge : " + p.getPackageCharge());
             //}
            // Packages packages = pbl.SearchPacagesById(1);
             //out.println("<br/>PackageName : "+ packages.getPackageName() + " Charge : " + packages.getPackageCharge());
             
             








***************************************************************End Method with more than one foregin key****************************************************

===============================Start oldtxt=======================
Database -> new connection->MYSQL(Connector/J driver)->next.....

DB conection

JDBC
===========================
..JDBC Connection pool
===========================
new -> poolname ->res type -> javax.sql.datasource -> vender->Mysql

Properties

password->shruti
url->jdbc:mysql://localhost:3306/ejdatabase?useSSL=false
URL->jdbc:mysql://localhost:3306/ejdatabase?useSSL=false
serverName->localhost
driver->com.mysql.jdbc.Driver
user->root
driverClass->com.mysql.jdbc.Driver
port->3306


finish->ping

=======================================================


===========================
..JDBC Resources
===========================

new -> JNDI name:jdbc/itpool
Poolname -> select pool name
ok


*****************************************************************************************************************************************************************



============================================================webApplicationCRUD=========================================

new web application
new->pU
new->entityclassefromdatabase
new ->sessionbean->in demo.java add (pu)
@Stateless
public class customer implements customerLocal {
 --@PersistenceContext(unitName = "Jsf_MultipalTable_crudPU")
   -- EntityManager em;
    @Override

...........change this in PU
      <persistence-unit name="multitable_crud_Final_PU" transaction-type="JTA">
      <jta-data-source>jdbc/itpool</jta-data-source>

=====================================
demolocal.java(bean)_
=====================================

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ejb;

import entity.Address;
import entity.Customer;
import java.util.Collection;
import javax.ejb.Local;

/**
 *
 * @author Admin
 */
@Local
public interface customerLocal {
     // ====  Customer =========
    Collection<Customer> getAllCustomers();
     //==== Address =================
     
     void addAddresOfCustomer(String street, String city, String state, String zip, Integer custId);
     void updateAddresOfCustomer(Integer addressId,String street, String city, String state, String zip, Integer custId);
     void removeAddressOfCustomer(Integer addressId, Integer custId);
     Collection<Address> getAddresesOfCustomer(Integer custId);
     Collection<Address> getAddressesByCity(String city);
     Collection<Address> getAddressesByState(String state);
     Collection<Address> getAddressesByZip(String zip);
     Collection<Address> getAddresses(String city, String State);
}

=====================================
demo.java(bean)
=====================================

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ejb;

import entity.Address;
import entity.Customer;
import java.util.Collection;
import javax.ejb.Stateless;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

/**
 *
 * @author Admin
 */
@Stateless
public class customer implements customerLocal {
@PersistenceContext(unitName = "multitable_crud_Final_PU")
    EntityManager em;
    @Override
    public Collection<Customer> getAllCustomers() {
        return em.createNamedQuery("Customer.findAll").getResultList();
    }

    @Override
    public void addAddresOfCustomer(String street, String city, String state, String zip, Integer custId) {
        Customer c = em.find(Customer.class, custId);
    Collection<Address> addresses = c.getAddressCollection();
    
    Address address = new Address();
    address.setStreet(street);
    address.setCity(city);
    address.setState(state);
    address.setZip(zip);
    address.setCustomerId(c); // Very Important
    
    addresses.add(address);
    c.setAddressCollection(addresses);
    
    em.persist(address);
    em.merge(c);
    }

    @Override
    public void updateAddresOfCustomer(Integer addressId, String street, String city, String state, String zip, Integer custId) {
         Address a=em.find(Address.class,addressId);
         Customer c = em.find(Customer.class, custId);
    
//         a.setAddressId(addressId);
         a.setState(state);
          a.setCity(city);
          a.setStreet(street);
          a.setZip(zip);
         a.setCustomerId(c);
         
       em.merge(a);
    }

    @Override
    public void removeAddressOfCustomer(Integer addressId, Integer custId) {
       Customer c = em.find(Customer.class, custId);
    Address address = em.find(Address.class, addressId);
    
    Collection<Address> addresses = c.getAddressCollection();
    
    if(addresses.contains(address))
    {
        addresses.remove(address);
        c.setAddressCollection(addresses);
        em.remove(address);
        em.merge(c);
    }
    }

    @Override
    public Collection<Address> getAddresesOfCustomer(Integer custId) {
        Customer c = em.find(Customer.class, custId);
    
   return c.getAddressCollection();
    }

    @Override
    public Collection<Address> getAddressesByCity(String city) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public Collection<Address> getAddressesByState(String state) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public Collection<Address> getAddressesByZip(String zip) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public Collection<Address> getAddresses(String city, String State) {
         return em.createNamedQuery("Address.findAll").getResultList();
    }

    // Add business logic below. (Right-click in editor and choose
    // "Insert Code > Add Business Method")
}



=================================
new->jsf cdi bean
scope->application



=====================================

folder Structure

JSF_Multipletable_crud
   -web pages
       -web-inf
          -editAddress.xhtml
          -index.xhtml
          -insert.xhtml
    -Source packages
       -customerAddress(Cdi bean)
            -ManagedBean.java
       -Ejb(sessionbean)
            -customer.java
            -customerLocal.java
       -entity
             
 =============
managedBean
================

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package customerAddress;

import ejb.customerLocal;
import entity.Address;
import entity.Customer;
import java.util.Collection;
import javax.annotation.PostConstruct;
import javax.ejb.EJB;
import javax.inject.Named;
import javax.enterprise.context.ApplicationScoped;
import javax.persistence.Basic;
import javax.persistence.Column;
import javax.persistence.JoinColumn;
import javax.persistence.ManyToOne;
import javax.validation.constraints.NotNull;
import javax.validation.constraints.Size;

/**
 *
 * @author Radhika Maniya
 */
@Named(value = "managedBean")
@ApplicationScoped
public class ManagedBean {

    @EJB
    private customerLocal customer;
    
    Customer c = new Customer();
    Address a = new Address();
    
    
            
    Collection<Customer> castomer;
    private int addressId;
    private int customerId;
    private String street;
    private String city;
    private String state;
    private String zip;

    public Customer getC() {
        return c;
    }

    public void setC(Customer c) {
        this.c = c;
    }

    public Address getA() {
        return a;
    }

    public void setA(Address a) {
        this.a = a;
    }

    public Collection<Customer> getCastomer() {
        return castomer;
    }

    public void setCastomer(Collection<Customer> castomer) {
        this.castomer = castomer;
    }

    public int getAddressId() {
        return addressId;
    }

    public void setAddressId(int addressId) {
        this.addressId = addressId;
    }

    public int getCustomerId() {
        return customerId;
    }

    public void setCustomerId(int customerId) {
        this.customerId = customerId;
    }

    public String getStreet() {
        return street;
    }

    public void setStreet(String street) {
        this.street = street;
    }

    public String getCity() {
        return city;
    }

    public void setCity(String city) {
        this.city = city;
    }

    public String getState() {
        return state;
    }

    public void setState(String state) {
        this.state = state;
    }

    public String getZip() {
        return zip;
    }

    public void setZip(String zip) {
        this.zip = zip;
    }

   
    /**
     * Creates a new instance of ManagedBean
     */
    public ManagedBean() {
       
    }
      @PostConstruct
    public void init(){
        castomer = customer.getAllCustomers();
    }
    public Collection<Address> ShowAddresses(){
           return customer.getAddresses(city, state);  
    }
    
    public String addAddress(){
        customer.addAddresOfCustomer(street, city, state, zip, customerId);
        return "index";
    }
    
    public void deleteAddress(){
       customer.removeAddressOfCustomer(addressId, customerId);
    }
    
    public String edit(Address A)
    {
        this.addressId=A.getAddressId();
        this.state=A.getState();
        this.city=A.getCity();
        this.street=A.getStreet();
        this.zip=A.getZip();
        Customer c = A.getCustomerId();
        this.customerId =c.getCustomerID();
        this.a = new Address();
        return "editAddress";
        
    }
    
    public String edit()
    {
        this.customer.updateAddresOfCustomer(addressId, street, city, state, zip, customerId);
        return "index";
    }
    
    public void delete(Address add)
    {
        this.addressId = add.getAddressId();
        Customer c = add.getCustomerId();
        this.customerId = c.getCustomerID();
        this.customer.removeAddressOfCustomer(addressId, customerId);
    }
}



=================================
editAddress.xml
=================================
     <?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        Hello from Facelets
        <h:form>
            state:<h:inputText value="#{managedBean.state}"></h:inputText><br/>
            city:<h:inputText value="#{managedBean.city}"></h:inputText><br/>
            street:<h:inputText value="#{managedBean.street}"></h:inputText><br/>
            zip:<h:inputText value="#{managedBean.zip}"></h:inputText><br/>
           
            <h:selectOneMenu value="#{managedBean.customerId}">
                <f:selectItems value="#{managedBean.castomer}" var="c" itemValue="#{c.customerID}" itemLabel="#{c.firstName}">
                </f:selectItems>
            </h:selectOneMenu>
            <h:commandButton value="save" action="#{managedBean.edit()}"></h:commandButton>
        </h:form>
        

    </h:body>
</html>

===========================
index.xhtml
===========================
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        Hello from Facelets<f:view>

 <h:link value="Add Mobile" outcome="insertAddress"></h:link>
            <h:form>
                <h1><h:outputText value="List"/></h1>
                <h:dataTable value="#{managedBean.ShowAddresses()}" var="item">
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="AddressId"/>
                        </f:facet>
                        <h:outputText value="#{item.addressId}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Street"/>
                        </f:facet>
                        <h:outputText value="#{item.street}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="City"/>
                        </f:facet>
                        <h:outputText value="#{item.city}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="State"/>
                        </f:facet>
                        <h:outputText value="#{item.state}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Zip"/>
                        </f:facet>
                        <h:outputText value="#{item.zip}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="CustomerId"/>
                        </f:facet>
                        <h:outputText value="#{item.customerId.firstName}"/>
                    </h:column>
                    <h:column>
                    <f:facet name="header">Option</f:facet>
                    <h:commandLink action="#{managedBean.delete(item)}" value="Delete"></h:commandLink>
                </h:column>
                <h:column>
                    <f:facet name="header">Option</f:facet>
                    <h:commandLink action="#{managedBean.edit(item)}" value="Edit"></h:commandLink>
                </h:column>
                </h:dataTable>
            </h:form>
        </f:view>

    </h:body>
</html>


============================
insertAddress.xhtml
==========================
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
          <h:head>
        <title>Facelet Title</title>
           </h:head>
    <h:body>

<h:form>
            state:<h:inputText value="#{managedBean.state}"></h:inputText><br/>
            city:<h:inputText value="#{managedBean.city}"></h:inputText><br/>
            street:<h:inputText value="#{managedBean.street}"></h:inputText><br/>
            zip:<h:inputText value="#{managedBean.zip}"></h:inputText><br/>
           
            <h:selectOneMenu value="#{managedBean.customerId}">
                <f:selectItems value="#{managedBean.castomer}" var="c" itemValue="#{c.customerID}" itemLabel="#{c.firstName}">
                </f:selectItems>
            </h:selectOneMenu>
            <h:commandButton value="save" action="#{managedBean.addAddress()}"></h:commandButton>
        </h:form>
    
    </h:body>
</html>
************************************************************************search**************************************************

/entity/Department.java			(Add the named query)
========================================================

@NamedQuery(name = "Department.findByDeptNames", query = "SELECT d FROM Department d WHERE d.deptName IN :deptNames")

========================================================
/beans/EmpBean.java				(Add this function with code)
========================================================
@Override
    public Collection<Employee> getEmpByDeptNames(Collection<String> deptNames) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        
        Collection<Department> depts=em.createNamedQuery("Department.findByDeptNames")
                .setParameter("deptNames", deptNames)
                .getResultList();
        
        Collection<Employee> emps=new ArrayList<Employee>();
        
        for(Department d:depts){
            emps.addAll(d.getEmployeeCollection());
        }
        return emps;
    }

===============================================
/ManagedBean/EmployeeBean
===============================================

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package managedBeans;

import beans.EmpBeanLocal;
import entity.Department;
import entity.Employee;
import entity.Project;
import java.util.ArrayList;
import java.util.Collection;
import java.util.List;
import javax.annotation.PostConstruct;
import javax.ejb.EJB;
import javax.ejb.Init;
import javax.inject.Named;
import javax.enterprise.context.ApplicationScoped;
import javax.validation.constraints.Min;
import javax.validation.constraints.Size;

/**
 *
 * @author kruti
 */
@Named(value = "employeeBean")
@ApplicationScoped
public class EmployeeBean {

    ///URL Not changing after edit, it should be reflect in url like "Display.xhtml"
    @EJB
    private EmpBeanLocal empBean;

    Employee emp=new Employee();
    Department dept=new Department();
    
    private Integer empId;
    
    private String fname;
    private String lname;
    
    //@Size(max=2, message = "Age must contain 2 digit number")  
    @Min(18)
    private int age;
    private int salary;
    private Integer deptId;
    
    //private Department dept;
    private Collection<Department> departments;
    private Collection<Project> projectCollection;
    private Collection<String> deptNms;
    
    public EmployeeBean() {
    }

    @PostConstruct          //IMPORTANT
    public void init(){
        this.departments=empBean.getAllDepartments();
        this.deptNms=new ArrayList<String>();
    }

    public Collection<String> getDeptNms() {
        return deptNms;
    }

    public void setDeptNms(Collection<String> deptNms) {
        this.deptNms = deptNms;
    }

    
    public Integer getEmpId() {
        return empId;
    }

    public void setEmpId(Integer empId) {
        this.empId = empId;
    }

    public String getFname() {
        return fname;
    }

    public void setFname(String fname) {
        this.fname = fname;
    }

    public String getLname() {
        return lname;
    }

    public void setLname(String lname) {
        this.lname = lname;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }

    public int getSalary() {
        return salary;
    }

    public void setSalary(int salary) {
        this.salary = salary;
    }

    public Integer getDeptId() {
        return deptId;
    }

    public void setDeptId(Integer deptId) {
        this.deptId = deptId;
    }

    public Collection<Project> getProjectCollection() {
        return projectCollection;
    }

    public void setProjectCollection(Collection<Project> projectCollection) {
        this.projectCollection = projectCollection;
    }

    public Department getDept() {
        return dept;
    }

    public void setDept(Department dept) {
        this.dept = dept;
    }
    
    public List<Employee> findAll(){
        
        if(deptNms.isEmpty()){
            
            return (List<Employee>) this.empBean.getAllEmployees();
        }else{
            
            return (List<Employee>) this.empBean.getEmpByDeptNames(deptNms);
        }
    
    }
    
    public String addEmployee(){
        
        empBean.addEmployee(fname, lname, age, salary, deptId);
        
        return "display";
    }
    
    public String edit(Employee e){
        this.emp=e;
        this.empId=e.getEmpId();
        this.dept=e.getDept();
        this.fname=e.getFname();
        this.lname=e.getLname();
        this.age=e.getAge();
        this.salary=e.getSalary();
        this.deptId=e.getDept().getDeptId();
        
        return "Edit";
    }

    public Collection<Department> getDepartments() {
        return departments;
    }

    public void setDepartments(Collection<Department> departments) {
        this.departments = departments;
    }
    
    
    
    public String edit(){
        
        empBean.updateEmployee(empId, fname, lname, age, salary, deptId);
        this.emp=null;
        this.empId=0;
        this.dept=null;
        this.fname="";
        this.lname="";
        this.age=0;
        this.salary=0;
        this.deptId=0;
        return "display";
    }
    
    public void deleteEmp(Integer id){
        empBean.deleteEmployee(id);
    }
}

========================================================
display.xhtml
========================================================

<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
     >
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        <center>
            <h:form>
                <br/>
                <h:link value="Add Employee" outcome="Insert"></h:link>
                
                <br/><br/>
                
                <h:selectManyCheckbox id="deptSel" value="#{employeeBean.deptNms}">
                    <f:ajax event="click" execute="deptSel" render="tb1" />
                    <f:selectItems value="#{employeeBean.departments}" var="d" itemValue="#{d.deptName}" itemLabel="#{d.deptName}">
                        
                    </f:selectItems>
                </h:selectManyCheckbox>
                
                
                <br/><br/>
        <h:dataTable id="tb1" var="e" value="#{employeeBean.findAll()}" border="1" cellpadding="1" width="500" cellspacing="1">
            <h:column>
                <f:facet name="header">Name</f:facet>
                <h:outputText value="#{e.fname} #{e.lname}"></h:outputText>
            </h:column>
            
            <h:column>
                <f:facet name="header">Age</f:facet>
                <h:outputText value="#{e.age}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Salary</f:facet>
                <h:outputText value="#{e.salary}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Department</f:facet>
                <h:outputText value="#{e.dept.deptName}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Edit</f:facet>
                <h:commandLink value="Edit" action="#{employeeBean.edit(e)}"></h:commandLink>
            </h:column>
            <h:column>
                <f:facet name="header">Delete</f:facet>
                <h:commandLink value="Delete" action="#{employeeBean.deleteEmp(e.empId)}" onclick="return confirm('Are you sure?')"></h:commandLink>
            </h:column>
        </h:dataTable>
            </h:form>
        </center>
    </h:body>
</html>


************************************************************************End search**************************************************



***************************************************************JSF validation****************************************************
Email Address:
          <h:inputText label="Email Address"
                       id="email" value="mailid" required="true"
                       requiredMessage="Please enter your email address."
		validatorMessage="Invalid email format">
          <f:validateRegex
		pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)(\.[A-Za-z]{2,})$" />
          </h:inputText>
          <h:message for="email" style="color: red"/>
//Primefaces


<p:password id="password" value="#{bean.password}" match="repeated_password" />

<p:password id="repeated_password" value="#{bean.password}" />

//second type


<h:inputSecret id="password" value="#{personHome.person.password}" />
<h:message for="password" />

<h:inputSecret id="password2" />
<h:message for="password2" />

<o:validateEqual components="password password2" 
    message="Passwords do not match!" showMessageFor="password2" />

//third type

<h:inputSecret id="password" value="#{personHome.person.password}">
  <f:ajax event="blur" render="passwordError" />
</h:inputSecret> 
<h:message for="password" errorClass="invalid" id="passwordError" />

<h:inputSecret id="password2" validator="#{personHome.validateSamePassword}">
  <f:ajax event="blur" render="password2Error" />
</h:inputSecret> 
<h:message for="password2" errorClass="invalid" id="password2Error" />


(bean)

@Named @ConversationScoped
public class PersonHome {
  private Person person;

  public Person getPerson() {
    if (person == null) return new Person();
    else return person;
  }

  public void validateSamePassword(context:FacesContext, toValidate:UIComponent, value:Object) {
    String confirmPassword = (String)value;
    if (!confirmPassword.equals(person.getPassword()) {
      FacesMessage message = new FacesMessage(FacesMessage.SEVERITY_ERROR, "Passwords do not match!", "Passwords do not match!")
      throw new Validatorexception(message);
    }
  }



phone no regu=^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$


***************************************************************End JSF validation****************************************************



***************************************************************Method with more than one foregin key****************************************************
----------------
beanlocal
-----------------

 Collection<Packages> getAllPackages();
      void addPackages(String PackageName,Integer CategoryID,Integer StateID,Integer NoOfDays,Integer NoOfNights,Integer PackageCharge, DateTime FromDate,DateTime ToDate,String Image1,String Image2,String Image3,String Image4,String ScheduleDescription);
      void updatePackages(Integer PackageID,String PackageName,Integer CategoryID,Integer StateID,Integer NoOfDays,Integer NoOfNights,Integer PackageCharge, DateTime FromDate,DateTime ToDate,String Image1,String Image2,String Image3,String Image4,String ScheduleDescription);
      void removePackages(Integer PackageID);
       Collection<Packages> SearchPacagesByName(String PackageName);
      Packages SearchPacagesById(Integer PackageID);
------------------------
bean.java
------------------------


    @Override
    public void addPackages(String PackageName, Integer CategoryID, Integer StateID, Integer NoOfDays, Integer NoOfNights, Integer PackageCharge, DateTime FromDate, DateTime ToDate, String Image1, String Image2, String Image3, String Image4, String ScheduleDescription) {
     Category c = em.find(Category.class, CategoryID);
     
//     System.out.println(c);
     State s=em.find(State.class,StateID);
     
     // !packagess.isEmpty() 
     
     if(c != null && s != null)
     {
        Collection<Packages> packagess = c.getPackagesCollection();
        Collection<Packages> packagess1 = s.getPackagesCollection();
     Packages packages = new Packages();
     packages.setPackageName(PackageName);
     packages.setCategoryID(c);
     packages.setStateID(s);
     packages.setNoOfDays(NoOfDays);
     packages.setNoOfNights(NoOfNights);
     packages.setPackageCharge(PackageCharge);
     //packages.setFromDate((Date) fromDate);  //new Date()
     packages.setFromDate(new Date());
     //packages.setToDate((Date) toDate);
     packages.setToDate(new Date());
     packages.setImage1(Image1);
     packages.setImage2(Image2);
     packages.setImage3(Image3);
     packages.setImage4(Image4);
     packages.setScheduleDescription(ScheduleDescription);
     packagess.add(packages);
     packagess1.add(packages);
        em.persist(packages);
        em.merge(c);
        em.merge(s);
     }
     
    
    // packages.setFromDate(fromDate);
     
    }


    @Override
    public void updatePackages(Integer PackageID, String PackageName, Integer CategoryID, Integer StateID, Integer NoOfDays, Integer NoOfNights, Integer PackageCharge, DateTime FromDate, DateTime ToDate, String Image1, String Image2, String Image3, String Image4, String ScheduleDescription) {
//        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
         Packages p= em.find(Packages.class,PackageID);
         
         Category c = em.find(Category.class, CategoryID);
         
         System.out.println(p);
         System.out.println(c);
         
         State s =em.find(State.class, StateID);
          System.out.println(s);
         p.setPackageName(PackageName);
         p.setCategoryID(c);
         p.setStateID(s);
         p.setNoOfDays(NoOfDays);
         p.setNoOfNights(NoOfNights);
         p.setPackageCharge(PackageCharge);
         p.setFromDate(new Date());
         p.setToDate(new Date());
         p.setImage1(Image1);
         p.setImage2(Image2);
         p.setImage3(Image3);
         p.setImage4(Image4);
         p.setScheduleDescription(ScheduleDescription);
         
         
                 
      
       em.merge(p);
    }

    @Override
    public void removePackages(Integer PackageID) {
         Packages p= em.find(Packages.class,PackageID);
         em.remove(p);
    
    }

    @Override
    public Collection<Packages> SearchPacagesByName(String PackageName) {
          Collection<Packages> packages = em.createNamedQuery("Packages.findByPackageName")
             .setParameter("packageName", PackageName)
             .getResultList();
     
     return packages;
    }

   
    @Override
    public Packages SearchPacagesById(Integer PackageID) {
        return em.find(Packages.class, PackageID);
    }



------------------------
servlet
----------------------
public class AdminServletFinal extends HttpServlet {
@EJB AdminBeanLocal pbl;



           //pbl.addPackages("second",1,3,3,3,30000,null ,null,"jkhjghj","hjkhk","hjvhjhj", "hgj","ghccghcgfcgf");
           // pbl.addPackages("first",1,2,2,3,300,null ,null,"jkhjghj","hjkhk","hjvhjhj", "hgj","ghccghcgfcgf");
           
           //pbl.updatePackages(1,"FIrstttt",1,3,2,30,10,null ,null,"jkhjghj","hjkhk","hjvhjhj", "hgj","ghccghcgfcgf");
           // pbl.removePackages(2);
            // Collection<Packages> packages = pbl.SearchPacagesByName("second");
             //for(Packages p : packages)
            // {
             // out.println("<br/>PackageName : "+ p.getPackageName() + " Charge : " + p.getPackageCharge());
             //}
            // Packages packages = pbl.SearchPacagesById(1);
             //out.println("<br/>PackageName : "+ packages.getPackageName() + " Charge : " + packages.getPackageCharge());
             
             








***************************************************************End Method with more than one foregin key****************************************************


****************************************************************EE Application CRUD**********************************************************




*****************************************************************************************************************************************************************
=========================================================

   CRUD (enterprise)(net)(jsf,ejb)
============================================================================



crud using EJB Jpa JSF

 ===new->project->Java EE->Enterpriseapplication->next->finish
===in ejb project folder with (demo-ejb) -> rightclick on source packages->create new entityclasses from db ->select connection pool->
give packagename(entities)->add table->next->select checkbox of create pu->collectiontype(Java.util.list)->finsih
======rightclic->soursepackage->new->other-> persitance->sessionbean for entity classes->next->add entity-> give package name(model)->finish
=======right click (demo-war ) -> properties->frameworks->add->javaserverfaces->ok->index.xhtml is addes
========remove index.html
=========in (demo-war) file source packages->new ->other->javaserver faces->JSF manages bean->package name(Controller)->scope(session)->finish
(optional 12.4) =========in mynetbeanse (demo-war)-> jsf ->jsf CDI bean(clientController)
=============check project -> demoJSFApp(first) -> clean and build -> and run
====in controller->insertcode->callenterpricebean->select(-ejb)->than (ex:personfadback)->ok->
   === add all method for opeation(crud)	
======================================================== 
public List<Customer> findAll(){
        return this.customerFacade.findAll();
    }

    -in index.xhtml->tack <h:form>
    -go to window
    -IDE tool
    -palette
    -JSF->JSF data table from entity->select->ok
    - code is added

=========================================================
take one instance in controller

 @EJB====auto
    private CustomerFacade customerFacade;======auto
    private Customer cust=new Customer();=====write this line
  right click -insert code->getter and setter->select first heckbox->geratate

insertmethod

public String insert()
    {
        this.customerFacade.create(cust);
        this.cust=new Customer();
        return "index";
    }

webpages->new ->jsfpage->give name insert
between trag and drop jsf form from entity->select->entity and all
add command button 
<h:commandButton value="Insert" action="#{clientController.insert()}"/>
-------------------------------------
--set link in index page()
   <h:link value="insert record" outcome="insert"/>

-----------------------------------
 
===================================================================================

delete

add one action column in index page\

 <h:column>
                            <f:facet name="header">
                                <h:outputText value="Action"/>
                            </f:facet>
                             <h:commandButton value="delete"
                                            action="#{clientController.delete(item)}" 
                                            onclick="return confirm('are you sure')" >
                                 
                             </h:commandButton>
                        </h:column>


        
add delete method in controller

 public String delete(Customer cust)
    {
        this.customerFacade.remove(cust);
        return "index";
    }



==================================================================

update

add colum in index

<h:column>
                            <f:facet name="header">
                                <h:outputText value="Action"/>
                            </f:facet>
                             <h:commandButton value="update"
                                              action="#{clientController.update(item)}">
                                 
                             </h:commandButton>
                        </h:column>       
   

------------------insert method in controller
  public String update(Customer cust)
    {
       this.cust=cust;
       return "update";
    }
    public String update()
    {
        this.customerFacade.edit(cust);
        return "index";
         
    }


new jsf page->update

 take jsf form from entity
add button at end
<h:commandButton value="update" action="#{clientController.update()}"/>


=====================================================================================================================================================

ClientController

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package controller;

import entity.Customer;
import javax.inject.Named;
import javax.enterprise.context.SessionScoped;
import java.io.Serializable;
import java.util.List;
import javax.ejb.EJB;
import model.CustomerFacade;

/**
 *
 * @author Admin
 */
@Named(value = "clientController")
@SessionScoped
public class clientController implements Serializable {

    @EJB
    private CustomerFacade customerFacade;
    private Customer cust=new Customer();

    /**
     * Creates a new instance of clientController
     */
    public clientController() {
    }

    public Customer getCust() {
        return cust;
    }

    public void setCust(Customer cust) {
        this.cust = cust;
    }
        
    public List<Customer> findAll(){
        return this.customerFacade.findAll();
    }
      
    public String delete(Customer cust)
    {
        this.customerFacade.remove(cust);
        return "index";
    }
    public String update(Customer cust)
    {
       this.cust=cust;
       return "update";
    }
    public String update()
    {
        this.customerFacade.edit(cust);
        return "index";
         
    }
}


====================================inedx.xhtml


<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Practice </title>
    </h:head>
    <h:body>
        <h:form>
            <f:view>


                <h:form>
                    <h1><h:outputText value="CustomerList"/></h1>
                    
                    <h:link value="insert record" outcome="insert"/>
                    
                    <h:dataTable value="#{clientController.findAll()}" var="item" border="1">
                        <h:column>
                            <f:facet name="header">
                                <h:outputText value="CustomerID"/>
                            </f:facet>
                            <h:outputText value="#{item.customerID}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                <h:outputText value="FirstName"/>
                            </f:facet>
                            <h:outputText value="#{item.firstName}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                <h:outputText value="LastName"/>
                            </f:facet>
                            <h:outputText value="#{item.lastName}"/>
                        </h:column>
                         <h:column>
                            <f:facet name="header">
                                <h:outputText value="Action"/>
                            </f:facet>
                             <h:commandButton value="delete"
                                            action="#{clientController.delete(item)}" 
                                            onclick="return confirm('are you sure')" >
                                 
                             </h:commandButton>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                <h:outputText value="Action"/>
                            </f:facet>
                             <h:commandButton value="update"
                                              action="#{clientController.update(item)}">
                                 
                             </h:commandButton>
                        </h:column>
                    </h:dataTable>
                </h:form>
            </f:view>

        </h:form>
    </h:body>
</html>



========================================update.xhtml



<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>update</title>
    </h:head>
    <h:body>
        <f:view>


            <h:form>
                <h1><h:outputText value="Create/Edit"/></h1>
                <h:panelGrid columns="2">
                    
                    <h:outputLabel value="FirstName:" for="firstName" />
                    <h:inputText id="firstName" value="#{clientController.cust.firstName}" title="FirstName" required="true" requiredMessage="The FirstName field is required."/>
                    <h:outputLabel value="LastName:" for="lastName" />
                    <h:inputText id="lastName" value="#{clientController.cust.lastName}" title="LastName" required="true" requiredMessage="The LastName field is required."/>\
                    <h:commandButton value="update" action="#{clientController.update()}"/>
                    
                    
                </h:panelGrid>
            </h:form>
        </f:view>
 
    </h:body>
</html>


============================================insert.xhtml

<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>insert details</title>
    </h:head>
    <h:body>
        <f:view>


            <h:form>
                <h1><h:outputText value="Createt"/></h1>
                <h:panelGrid columns="2">
                    <h:outputLabel value="CustomerID:" for="customerID" />
                    <h:inputText id="customerID" value="#{clientController.cust.customerID}" title="CustomerID" required="true" requiredMessage="The CustomerID field is required."/>
                    <h:outputLabel value="FirstName:" for="firstName" />
                    <h:inputText id="firstName" value="#{clientController.cust.firstName}" title="FirstName" required="true" requiredMessage="The FirstName field is required."/>
                    <h:outputLabel value="LastName:" for="lastName" />
                    <h:inputText id="lastName" value="#{clientController.cust.lastName}" title="LastName" required="true" requiredMessage="The LastName field is required."/>
                    <h:commandButton value="Insert" action="#{clientController.insert()}"/>
                </h:panelGrid>
            </h:form>
        </f:view>

    </h:body>
</html>


=======================validation=====================
   <h:inputText id="deptName" value="#{departmentbean.deptName}" title="Departemnt Name" required="true"
                                 requiredMessage="This field is required"  /><br/>

======================================================



===============================End oldtxt=======================

=============================================start msg queue===============================
The websimplemessage Facelets Pages
The Facelets pages for the example are as follows.

sender.xhtml, which provides a labeled h:InputText tag where the user enters the message, along with two command buttons. When the user clicks the Send Message button, the senderBean.sendMessage method is called to send the message to the queue and display its contents. When the user clicks the Go to Receive Page button, the receiver.xhtml page appears.

receiver.xhtml, which also provides two command buttons. When the user clicks the Receive Message button, the receiverBean.getMessage method is called to fetch the message from the queue and display its contents. When the user clicks the Send Another Message button, the sender.xhtml page appears again.


The websimplemessage Managed Beans
The two managed beans for the example are as follows.

SenderBean.java, a CDI managed bean with one property, messageText, and one business method, sendMessage. The class is annotated with @JMSDestinationDefinition to create a component-private queue:

@JMSDestinationDefinition(
        name = "java:comp/jms/webappQueue",
        interfaceName = "javax.jms.Queue",
        destinationName = "PhysicalWebappQueue")
@Named
@RequestScoped
public class SenderBean {
The sendMessage method injects a JMSContext (using the default connection factory) and the queue, creates a producer, sends the message the user typed on the Facelets page, and creates a FacesMessage to display on the Facelets page:

@Inject
private JMSContext context;
@Resource(lookup = "java:comp/jms/webappQueue")
private Queue queue;
private String messageText;
...
public void sendMessage() {
    try {
        String text = "Message from producer: " + messageText;
        context.createProducer().send(queue, text);

        FacesMessage facesMessage =
                new FacesMessage("Sent message: " + text);
        FacesContext.getCurrentInstance().addMessage(null, facesMessage);
    } catch (Throwable t) {
        logger.log(Level.SEVERE,
                "SenderBean.sendMessage: Exception: {0}",
                t.toString());
    }
}
ReceiverBean.java, a CDI managed bean with one business method, getMessage. The method injects a JMSContext (using the default connection factory) and the queue that was defined in SenderBean, creates a consumer, receives the message, and creates a FacesMessage to display on the Facelets page:

@Inject
private JMSContext context;
@Resource(lookup = "java:comp/jms/webappQueue")
private Queue queue;
...
public void getMessage() {
    try {
        JMSConsumer receiver = context.createConsumer(queue);
        String text = receiver.receiveBody(String.class);

        if (text != null) {
            FacesMessage facesMessage =
                    new FacesMessage("Reading message: " + text);
            FacesContext.getCurrentInstance().addMessage(null, facesMessage);
        } else {
            FacesMessage facesMessage =
                    new FacesMessage("No message received after 1 second");
            FacesContext.getCurrentInstance().addMessage(null, facesMessage);
        }
    } catch (Throwable t) {
        logger.log(Level.SEVERE,
                "ReceiverBean.getMessage: Exception: {0}",
                t.toString());
    }
}
=============================================end msg queue================================

==============================================Start rrrrrr====================================
=====================================================================================================================================
  password
  url
  jdbc:mysql://localhost:3306/travelmanagementsystem?useSSL=false 
  URL
  jdbc:mysql://localhost:3306/travelmanagementsystem?useSSL=false
  serverName
  localhost
  driver
  com.mysql.jdbc.Driver
  user
  root
  driverClass
  com.mysql.jdbc.Driver
  port
  3306
===============================================
empfinalmix,jsf_kruti = ejbempdb
jsf_jpa_rest_ejb = externaldb
jsf_multipletablecrud = clgsir
=====================================COMPLETE JSF CRUD WITH SEARCH,rest,jpa,ejb=======================================================
1.new-other-context and dependency inject...-beans.xml(CDI confi.. file) and discovery="annoted" ni jagya e "all"
       bean-discovery-mode="all">
2.

 <persistence-unit name="EmpFinalMixPU" transaction-type="JTA">
    <jta-data-source>jdbc/mscit</jta-data-source>
  
    <properties/>


3.session bean
----------------
localbean
--------------------------------------
 //Department
    void addDepartment(String deptName);
    void updateDepartment(Integer deptId, String deptName);
    void deleteDepartment(Integer deptId);
    Collection<Department> getAllDepartments();
    
    
    //Employee
    void addEmployee(String fname, String lname, int age, int salary, Integer deptId);
    void updateEmployee(Integer empId, String fname, String lname, int age, int salary, Integer deptId);
    void deleteEmployee(Integer empId);
    Collection<Employee> getAllEmployees();
    
    //Project
    void addProject(String projectName, int cost, String startDate);
    void updateProject(Integer projectId,String projectName, int cost, String startDate);
    void deleteProject(Integer projectId);
    Collection<Project> getAllProjects();
    
    void addEmployeesToProject(Integer projectId,Collection<Integer> empIds);
    void removeEmployeesToProject(Integer projectId,Collection<Integer> empIds);
    
    //Searching methods
    
    Collection<Project> getEmpProjects(Integer EmpId);
    Collection<Employee> getProjectEmps(Integer ProjectId);
    Collection<Employee> getEmpByDeptName(String deptName);
    Collection<Employee> getEmpByDeptNames(Collection<String> deptNames);
    Collection<Employee> getEmpByDeptAndSalary(String deptName,int salary);
    Collection<Employee> getEmpBySalary(int salary);
    Collection<Employee> getEmpByDeptId(Integer deptId);
    Collection<Project> getProjectByName(String projectName);
    Collection<Project> getProjectWithinCostRange(int startCost,int endCost);
    ---------------------------------------------------

bean code
--------------
 @PersistenceContext(unitName="EmpFinalMixPU")
    EntityManager em;

    @Override
    public void addDepartment(String deptName) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Department d=new Department(deptName);
        em.persist(d);
    
    }

    @Override
    public void updateDepartment(Integer deptId, String deptName) {
        
        Department d=(Department) em.find(Department.class,deptId);
        d.setDeptName(deptName);
        em.merge(d);
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public void deleteDepartment(Integer deptId) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Department d=(Department) em.find(Department.class,deptId);
        em.remove(d);
    }

    @Override
    public Collection<Department> getAllDepartments() {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        return em.createNamedQuery("Department.findAll").getResultList();
    }

    @Override
    public void addEmployee(String fname, String lname, int age, int salary, Integer deptId) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Employee e=new Employee(fname,lname,age,salary);
        Department d=(Department) em.find(Department.class,deptId);
        e.setDept(d);
        
        
        Collection<Employee> empCol=d.getEmployeeCollection();
        empCol.add(e);
        d.setEmployeeCollection(empCol);
        
        em.persist(e);
        em.merge(d);
    }
    

    @Override
    public void updateEmployee(Integer empId, String fname, String lname, int age, int salary, Integer deptId) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Employee e=(Employee) em.find(Employee.class,empId);
        
        Integer oldDept=e.getDept().getDeptId();
        
        e.setFname(fname);
        e.setLname(lname);
        e.setAge(age);
        e.setSalary(salary);
        
        Department d=(Department) em.find(Department.class,deptId);
        e.setDept(d);
        
        
        Collection<Employee> eCol;
        Collection<Employee> oeCol;
        if(oldDept!=d.getDeptId()){
            eCol=d.getEmployeeCollection();
            eCol.add(e);
            d.setEmployeeCollection(eCol);
            
            Department od=(Department) em.find(Department.class,oldDept);
            oeCol=od.getEmployeeCollection();
            oeCol.remove(e);
            od.setEmployeeCollection(oeCol);
            em.merge(od);
        }
        
        em.merge(e);
        em.merge(d);
    }

    @Override
    public void deleteEmployee(Integer empId) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Employee e=(Employee) em.find(Employee.class, empId);
        Department d=e.getDept();
        
        
        
        Collection eCol=d.getEmployeeCollection();
        eCol.remove(e);
        d.setEmployeeCollection(eCol);
        
        em.remove(e);
        em.merge(d);
    
    }

    @Override
    public Collection<Employee> getAllEmployees() {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        return em.createNamedQuery("Employee.findAll").getResultList();
    }

    @Override
    public void addProject(String projectName, int cost, String startDate) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Project p=new Project(projectName,cost,startDate);
        em.persist(p);
    }

    @Override
    public void updateProject(Integer projectId, String projectName, int cost, String startDate) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Project p=(Project) em.find(Project.class,projectId);
        p.setProjectName(projectName);
        p.setCost(cost);
        p.setStartDate(startDate);
        em.merge(p);
    }

    @Override
    public void deleteProject(Integer projectId) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Project p=(Project) em.find(Project.class,projectId);
        em.remove(p);
    }

    @Override
    public Collection<Project> getAllProjects() {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        return em.createNamedQuery("Project.findAll").getResultList();
    }

    @Override
    public void addEmployeesToProject(Integer projectId, Collection<Integer> empIds) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
        Project p=(Project) em.find(Project.class, projectId);
        
        //Check if employee already added ?
        
        Collection<Employee> eCol=p.getEmployeeCollection();
        
        for(Integer eId:empIds){
            
            Employee e=(Employee) em.find(Employee.class,eId);
            if(!eCol.contains(e)){
                
               
                eCol.add(e);
                p.setEmployeeCollection(eCol);
                
                Collection<Project> pCol=e.getProjectCollection();
                pCol.add(p);
                e.setProjectCollection(pCol);
                em.merge(p);
                
            }
        }
        
    }

    @Override
    public void removeEmployeesToProject(Integer projectId, Collection<Integer> empIds) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Project p=(Project) em.find(Project.class, projectId);
        
        //Check if employee already added ?
        
        Collection<Employee> eCol=p.getEmployeeCollection();
        for(Integer eId:empIds){
            
            Employee e=(Employee) em.find(Employee.class,eId);
            if(eCol.contains(e)){
                
                eCol.remove(e);
                p.setEmployeeCollection(eCol);
                
                Collection<Project> pCol=e.getProjectCollection();
                pCol.remove(p);
                e.setProjectCollection(pCol);
                em.merge(p);    //IMPORTANT
                
            }
        }
    
    }

    @Override
    public Collection<Project> getEmpProjects(Integer EmpId) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Employee e=(Employee) em.find(Employee.class, EmpId);
        return e.getProjectCollection();
    }

    @Override
    public Collection<Employee> getProjectEmps(Integer ProjectId) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Project p=(Project) em.find(Project.class, ProjectId);
        return p.getEmployeeCollection();
    }

    @Override
    public Collection<Employee> getEmpByDeptName(String deptName) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Collection<Department> depts=em.createNamedQuery("Department.findByDeptName")
                .setParameter("deptName", deptName)
                .getResultList();
        
        Collection<Employee> emps=new ArrayList<Employee>();
        
        for(Department d:depts){
            emps.addAll(d.getEmployeeCollection());
        }
        return emps;
    }
    
    @Override
    public Collection<Employee> getEmpByDeptNames(Collection<String> deptNames) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        
        Collection<Department> depts=em.createNamedQuery("Department.findByDeptNames")
                .setParameter("deptNames", deptNames)
                .getResultList();
        
        Collection<Employee> emps=new ArrayList<Employee>();
        
        for(Department d:depts){
            emps.addAll(d.getEmployeeCollection());
        }
        return emps;
    }

    @Override
    public Collection<Employee> getEmpByDeptAndSalary(String deptName, int salary) {
        Collection<Department> depts=em.createNamedQuery("Department.findByDeptName")
                .setParameter("deptName", deptName)
                .getResultList();
        
        Collection<Employee> emps=new ArrayList<Employee>();
        Collection<Employee> empsFinal=new ArrayList<Employee>();
        
        for(Department d:depts){
            emps.addAll(d.getEmployeeCollection());
        }
        
        for(Employee e:emps){
            if(e.getSalary()>=salary){
                empsFinal.add(e);
            }
        }
        
        return empsFinal;
    }

    @Override
    public Collection<Employee> getEmpBySalary(int salary) {
        return em.createNamedQuery("Employee.findBySalary").setParameter("salary", salary).getResultList();
    }

    @Override
    public Collection<Employee> getEmpByDeptId(Integer deptId) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Department d=(Department) em.find(Department.class, deptId);
        return d.getEmployeeCollection();
    }

    @Override
    public Collection<Project> getProjectByName(String projectName) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Collection<Project> pCol=em.createNamedQuery("Project.findByProjectName")
                .setParameter("projectName", projectName)
                .getResultList();
        
        return pCol;
    }

    @Override
    public Collection<Project> getProjectWithinCostRange(int startCost, int endCost) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        
        Collection<Project> pCol=em.createNamedQuery("Project.findByCostRange")
                .setParameter("startRange", startCost)
                .setParameter("endRange",endCost)
                .getResultList();
        
        return pCol;
    }
-----------------------------------------------------------
entity
-----------------
    @NamedQuery(name = "Department.findByDeptNames", query = "SELECT d FROM Department d WHERE d.deptName IN :deptNames")})
----------------------------------------------------
REST
-----------------------------------

    @EJB EmpBeanLocal ebl;

    @Path("getAllEmployees")
    @GET
    @Produces(MediaType.APPLICATION_JSON)
    public Collection<Employee> getAllEmployees() {
        return ebl.getAllEmployees();
    }
   
    
    @Path("getEmpByDeptNames")
    @POST
    @Consumes(MediaType.APPLICATION_JSON)
    @Produces(MediaType.APPLICATION_JSON)
    public Collection<Employee> getEmpByDeptNames(Collection<String> deptNames) {
        
        
        return ebl.getEmpByDeptNames(deptNames);
    }
--------------------------------------
create client
-----------------------------------
Managedbean(their is two manage bean 1.RestEmployeeBean 2.EmployeeBean)
------------
@EJB EmpBeanLocal empBean;
    EmpClient ec;
    Response res;

    Employee emp=new Employee();
    Department dept=new Department();
    
    private Integer empId;
    
    private String fname;
    private String lname;
    
    //@Size(max=2, message = "Age must contain 2 digit number")  
    @Min(18)
    private int age;
    private int salary;
    private Integer deptId;
    
    //private Department dept;
    private Collection<Department> departments;
    private Collection<Project> projectCollection;
    private Collection<String> deptNms;
    private GenericType<Collection<Employee>> gEmps;
    private String deptName;
    
    public RestEmployeeBean() {
    }

    @PostConstruct          //IMPORTANT
    public void init(){
        ec=new EmpClient();
        this.departments=empBean.getAllDepartments();
        
        this.deptNms=new ArrayList<String>();
        this.deptName="";
        gEmps=new GenericType<Collection<Employee>>(){};
    }

    public String getDeptName() {
        return deptName;
    }

    public void setDeptName(String deptName) {
        this.deptName = deptName;
    }

    public Collection<String> getDeptNms() {
        return deptNms;
    }

    public void setDeptNms(Collection<String> deptNms) {
        this.deptNms = deptNms;
    }

    
    public Integer getEmpId() {
        return empId;
    }

    public void setEmpId(Integer empId) {
        this.empId = empId;
    }

    public String getFname() {
        return fname;
    }

    public void setFname(String fname) {
        this.fname = fname;
    }

    public String getLname() {
        return lname;
    }

    public void setLname(String lname) {
        this.lname = lname;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }

    public int getSalary() {
        return salary;
    }

    public void setSalary(int salary) {
        this.salary = salary;
    }

    public Integer getDeptId() {
        return deptId;
    }

    public void setDeptId(Integer deptId) {
        this.deptId = deptId;
    }

    public Collection<Project> getProjectCollection() {
        return projectCollection;
    }

    public void setProjectCollection(Collection<Project> projectCollection) {
        this.projectCollection = projectCollection;
    }

    public Department getDept() {
        return dept;
    }

    public void setDept(Department dept) {
        this.dept = dept;
    }
    
    public List<Employee> findAll(){
        
        if(deptNms.isEmpty()){
            res=ec.getAllEmployees(Response.class);
            return (List<Employee>) res.readEntity(gEmps);
            //return (List<Employee>) this.empBean.getAllEmployees();
        }else{
            res=ec.getEmpByDeptNames(deptNms,Response.class);
            return (List<Employee>) res.readEntity(gEmps);
            //return (List<Employee>) this.empBean.getEmpByDeptNames(deptNms);
        }
    
    }
    
    public List<Employee> filterEmpList(){
        System.out.println(deptName);
        
        if((deptName=="" && salary==0) || (deptName.equals("All")&& salary==0)){
            
            return (List<Employee>) this.empBean.getAllEmployees();
        }else if(deptName.equals("All")&& salary!=0){
            
            return (List<Employee>) this.empBean.getEmpBySalary(salary);
        }else{
            return (List<Employee>) this.empBean.getEmpByDeptAndSalary(deptName,salary);
        }
    }
    
    public String addEmployee(){
        
        empBean.addEmployee(fname, lname, age, salary, deptId);
        
        return "display";
    }
    
    public String edit(Employee e){
        this.emp=e;
        this.empId=e.getEmpId();
        this.dept=e.getDept();
        this.fname=e.getFname();
        this.lname=e.getLname();
        this.age=e.getAge();
        this.salary=e.getSalary();
        this.deptId=e.getDept().getDeptId();
        
        return "Edit";
    }

    public Collection<Department> getDepartments() {
        return departments;
    }

    public void setDepartments(Collection<Department> departments) {
        this.departments = departments;
    }
    
    
    
    public String edit(){
        
        empBean.updateEmployee(empId, fname, lname, age, salary, deptId);
        this.emp=null;
        this.empId=0;
        this.dept=null;
        this.fname="";
        this.lname="";
        this.age=0;
        this.salary=0;
        this.deptId=0;
        return "display";
    }
    
    public void deleteEmp(Integer id){
        empBean.deleteEmployee(id);
    }
    
-----------------------------------------
JSF
-------------------------------------------------------------------------------------------------
display.xhtml
-----------
<center>
            <h:form>
                <br/>
                <h:link value="Add Employee" outcome="Insert"></h:link>
                
                <br/><br/>
                
                <h:selectManyCheckbox id="deptSel" value="#{employeeBean.deptNms}">
                    <f:ajax event="click" execute="deptSel" render="tb1" />
                    <f:selectItems value="#{employeeBean.departments}" var="d" itemValue="#{d.deptName}" itemLabel="#{d.deptName}">
                        
                    </f:selectItems>
                </h:selectManyCheckbox>
                
                <br/><br/>
        <h:dataTable id="tb1" var="e" value="#{employeeBean.findAll()}" border="1" cellpadding="1" width="500" cellspacing="1">
            <h:column>
                <f:facet name="header">Name</f:facet>
                <h:outputText value="#{e.fname} #{e.lname}"></h:outputText>
            </h:column>
            
            <h:column>
                <f:facet name="header">Age</f:facet>
                <h:outputText value="#{e.age}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Salary</f:facet>
                <h:outputText value="#{e.salary}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Department</f:facet>
                <h:outputText value="#{e.dept.deptName}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Edit</f:facet>
                <h:commandLink value="Edit" action="#{employeeBean.edit(e)}"></h:commandLink>
            </h:column>
            <h:column>
                <f:facet name="header">Delete</f:facet>
                <h:commandLink value="Delete" action="#{employeeBean.deleteEmp(e.empId)}" onclick="return confirm('Are you sure?')"></h:commandLink>
            </h:column>
        </h:dataTable>
            </h:form>
        </center>
-------------------------------------------------------------------------------------------------
search.xhtml
-----------------------------------------
<h:form>
            <center>
                <h1>Search Employee Form</h1>
                
                <h:outputLabel value="Department :  " for="deptName" />
                
                <h:selectOneMenu id="deptName" value="#{employeeBean.deptName}">
                    <f:selectItem itemValue="All" itemLabel="All"></f:selectItem>
                    <f:selectItems var="d" value="#{employeeBean.departments}" itemValue="#{d.deptName}" itemLabel="#{d.deptName}">
                        
                    </f:selectItems>
                </h:selectOneMenu>
    
                <br/><br/>
                <h:outputLabel value="Minimum range for salary : " for="sal"/>
                <h:inputText value="#{employeeBean.salary}" />
                
                <br/><br/>
                <h:commandButton id="b1" value="Search" action="#{employeeBean.filterEmpList()}">
<!--                    <f:ajax event="click" execute="deptName" render="tb1" />-->
                </h:commandButton>
                
                <br/><br/>
                <h:dataTable id="tb1" var="e" border="2" value="#{employeeBean.filterEmpList()}" cellpadding="2" cellspacing="2" width="600">
                    <h:column>
                        <f:facet name="header">Name</f:facet>
                        <h:outputText value="#{e.fname} #{e.lname}"/>
                    </h:column>
                    
                    <h:column>
                        <f:facet name="header">Age</f:facet>
                        <h:outputText value="#{e.age}"/>
                    </h:column>
                    
                    <h:column>
                        <f:facet name="header">Salary</f:facet>
                        <h:outputText value="#{e.salary}"/>
                    </h:column>
                    
                    <h:column>
                        <f:facet name="header">Department</f:facet>
                        <h:outputText value="#{e.dept.deptName}"/>
                    </h:column>
                </h:dataTable>
            </center>
        </h:form>
------------------------------------------------------------------------
insert.xhtml
----------------------------
<h:form>
            <h1><h:outputText value="Add Employee" /></h1>
<!--            <h:panelGrid >-->
                <h:outputLabel value="First Name" for="fname"/>
                <h:inputText id="fname" value="#{employeeBean.fname}" required="true" requiredMessage="First name should not be empty!" />
                <h:message for="fname" style=" color: red"/>  
            <br/>
                <h:outputLabel value="Last Name" for="lname"/>
                <h:inputText id="lname" value="#{employeeBean.lname}" required="true" requiredMessage="Last name should not be empty!" />
                <h:message for="lname" style=" color: red"/>  
            <br/>
                <h:outputLabel value="Age" for="age"/>
                <h:inputText id="age" value="#{employeeBean.age}" required="true" requiredMessage="Age should not be empty!" />
                <h:message for="age" style=" color: red"/>  
            <br/>  
                <h:outputLabel value="Salary" for="salary"/>
                <h:inputText id="salary" value="#{employeeBean.salary}" required="true" requiredMessage="Salary should not be empty!" />
            <br/>
                <h:outputLabel value="Department" for="deptId"/>
                <h:selectOneMenu id="deptId" value="#{employeeBean.deptId}">
                    <f:selectItems value="#{employeeBean.departments}" var="d" itemValue="#{d.deptId}" itemLabel="#{d.deptName}">
                        
                    </f:selectItems>
                </h:selectOneMenu>
             <br/>   
                <h:commandButton action="#{employeeBean.addEmployee()}" value="ADD" />
            <!--</h:panelGrid>-->
        </h:form>
----------------------------------------------------------
edit.xhtml
----------------------------
<h:form>
            <h1><h:outputText value="Edit Employee" /></h1>
            <h:inputHidden value="#{employeeBean.empId}" />
            <h:panelGrid columns="2">
                
                <h:outputLabel value="First Name" for="fname"/>
                <h:inputText id="fname" value="#{employeeBean.fname}" required="true" requiredMessage="First name should not be empty!" />
            
                <h:outputLabel value="Last Name" for="lname"/>
                <h:inputText id="lname" value="#{employeeBean.lname}" required="true" requiredMessage="Last name should not be empty!" />
            
                <h:outputLabel value="Age" for="age"/>
                <h:inputText id="age" value="#{employeeBean.age}" required="true" requiredMessage="Age should not be empty!" />
            
                
                <h:outputLabel value="Salary" for="salary"/>
                <h:inputText id="salary" value="#{employeeBean.salary}" required="true" requiredMessage="Salary should not be empty!" />
            
                <h:outputLabel value="Department" for="deptId"/>
                <h:selectOneMenu id="deptId" value="#{employeeBean.deptId}">
                    <f:selectItems value="#{employeeBean.departments}" var="d" itemValue="#{d.deptId}" itemLabel="#{d.deptName}">
                        
                    </f:selectItems>
                </h:selectOneMenu>
                
                <h:commandButton action="#{employeeBean.edit()}" value="SAVE" />
            </h:panelGrid>
        </h:form>








===================================2 table crud with REST,JSF=========================================
beanlocal
--------------------------------------------------------------------------
 Collection<Category> getAllCategory();
    Collection<Product> getAllproduct();
     void addProduct(Integer cid,String pname,String brandname);
     void updateProduct(Integer pid,Integer cid,String pname,String brandname);
     void removeProduct(Integer pid,Integer cid);
------------------------------------------------------------------------------
bean
------------------------------
 EntityManager em;
   
    @Override
    public Collection<Product> getAllproduct() {
                  return em.createNamedQuery("Product.findAll").getResultList();

    }

    @Override
    public void addProduct(Integer cid, String pname, String brandname) {
    Category c = em.find(Category.class, cid);
    Collection<Product> products = c.getProductCollection();
    Product product = new Product();
    product.setPname(pname);
    product.setCid(c);
    product.setBrandname(brandname);
    products.add(product);
    c.setProductCollection(products);
    em.persist(product);
    em.merge(c);   
    }

    @Override
    public void updateProduct(Integer pid, Integer cid, String pname, String brandname) {
 Product p=em.find(Product.class,pid);
         Category c = em.find(Category.class,cid);
    
//         a.setAddressId(addressId);
       p.setCid(c);
       p.setPname(pname);
        p.setBrandname(brandname);
         
       em.merge(p);
    }

    @Override
    public void removeProduct(Integer pid, Integer cid) {
  Category c = em.find(Category.class, cid);
    
     Product product = em.find(Product.class,pid);
    Collection<Product> products = c.getProductCollection();
    if(products.contains(product))
    {
        products.remove(product);
        c.setProductCollection(products);
        em.remove(product);
        em.merge(c);
    }
    }

    @Override
    public Collection<Category> getAllCategory() {
        return em.createNamedQuery("Category.findAll").getResultList();
    }
---------------------------------------------------------------------------------------
REST
----------------------------
@EJB beanLocal pbl;
    @Context
    private UriInfo context;

    public GenericResource() {
    }
    @GET
    @Produces(MediaType.APPLICATION_XML)
    @Path("getAllproduct")
   public Collection<Product> getAllproduct() {
        return pbl.getAllproduct();
    }
    @GET
    @Produces(MediaType.APPLICATION_XML)
    @Path("getAllCategory")
    public Collection<Category> getAllCategory(){
        return pbl.getAllCategory();
    }
    
   @Path("addproduct/{cid}/{pname}/{brandname}")
    @POST
    public void addProduct(@PathParam("cid") Integer cid,@PathParam("pname") String pname,@PathParam("brandname") String brandname) {
       pbl.addProduct(cid, pname, brandname);
    }
    @Path("updateproduct/{pid}/{cid}/{pname}/{brandname}")
    @POST
    public void updateProduct(@PathParam("pid")Integer pid,@PathParam("cid") Integer cid,@PathParam("pname") String pname,@PathParam("brandname") String brandname) {
        pbl.updateProduct(pid, cid, pname, brandname);
    }

   @Path("removeproduct/{pid}/{cid}")
    @DELETE
    public void removeProduct(@PathParam("pid")Integer pid,@PathParam("cid") Integer cid) {
        pbl.removeProduct(pid, cid);
    }
-----------------------------------------------------------------------------
managebean
------------------------------------
 restClient restc=new restClient();
    private Response res;
    private GenericType<Collection<Product>> productgeneric;
    private GenericType<Collection<Category>> categorygeneric;
       Product product = new Product();
   private String pid,name,cid,brandname;
    Collection<Category> categorylist;

    public restClient getRestc() {
        return restc;
    }

    public void setRestc(restClient restc) {
        this.restc = restc;
    }

    public Response getRes() {
        return res;
    }

    public void setRes(Response res) {
        this.res = res;
    }

    public GenericType<Collection<Product>> getProductgeneric() {
        return productgeneric;
    }

    public void setProductgeneric(GenericType<Collection<Product>> productgeneric) {
        this.productgeneric = productgeneric;
    }

    public GenericType<Collection<Category>> getCategorygeneric() {
        return categorygeneric;
    }

    public void setCategorygeneric(GenericType<Collection<Category>> categorygeneric) {
        this.categorygeneric = categorygeneric;
    }

    public Product getProduct() {
        return product;
    }

    public void setProduct(Product product) {
        this.product = product;
    }

    public String getPid() {
        return pid;
    }

    public void setPid(String pid) {
        this.pid = pid;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getCid() {
        return cid;
    }

    public void setCid(String cid) {
        this.cid = cid;
    }

    public String getBrandname() {
        return brandname;
    }

    public void setBrandname(String brandname) {
        this.brandname = brandname;
    }

    public Collection<Category> getCategorylist() {
        return categorylist;
    }

    public void setCategorylist(Collection<Category> categorylist) {
        this.categorylist = categorylist;
    }

    

    public JSFManagedBean() {
    }
    
    @PostConstruct
    public void init(){
       categorygeneric = new GenericType<Collection<Category>>(){};
       res = restc.getAllCategory(Response.class);
       this.categorylist = res.readEntity(categorygeneric);
       
//       brandgeneric = new GenericType<Collection<Brandtb>>(){};
//       res = productclient.getAllBrand(Response.class);
//       this.brandlist = res.readEntity(brandgeneric);
    }
    
    public Collection<Product> findAll(){
            productgeneric = new GenericType<Collection<Product>>(){};
            res = restc.getAllproduct(Response.class);
            Collection<Product> product = res.readEntity(productgeneric);
            return product;
    }
    
    public String add(){
        restc.addProduct(cid, name, brandname);
        this.product = new Product();
        return "display";
    }
    
    public void delete(Product p){
        this.pid = p.getPid().toString();
        Category c = p.getCid();
        this.cid = c.getCid().toString();
        restc.removeProduct(pid, cid);
        
    }
    
    public String edit(Product p){
        this.pid = p.getPid().toString();
        Category c = p.getCid();
        this.cid = c.getCid().toString();
       
        this.name = p.getPname();
        this.brandname = p.getBrandname();
        this.product=new Product();
        return "edit";
    }
    
    public String edit(){
        restc.updateProduct(pid, cid, name, brandname);
//        this.product = new Product();
        return "display";
    }
---------------------------------------------------------------------
JSF--------------------------
display
-------------------------------------
<h:form>
<!--                <h:selectManyCheckbox id="deptSel" value="#{jSFManagedBean.cid}">
                    <f:ajax event="click" execute="prodsearch" render="tb1" />
                    <f:selectItems value="#{jSFManagedBean.categorylist}" var="d" itemValue="#{d.cid}" itemLabel="#{d.cname}">
                        
                    </f:selectItems>
                </h:selectManyCheckbox>-->
                <h1><h:outputText value="List"/></h1>
                    <h:dataTable value="#{jSFManagedBean.findAll()}" var="item">
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Pid"/>
                        </f:facet>
                        <h:outputText value="#{item.pid}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Pname"/>
                        </f:facet>
                        <h:outputText value="#{item.pname}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Brandname"/>
                        </f:facet>
                        <h:outputText value="#{item.brandname}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Cid"/>
                        </f:facet>
                        <h:outputText value="#{item.cid.cname}"/>
                    </h:column>
                    <h:column>
                <f:facet name="header">Edit</f:facet>
                <h:commandLink value="Edit" action="#{jSFManagedBean.edit(item)}"></h:commandLink>
            </h:column>
            <h:column>
                <f:facet name="header">Delete</f:facet>
                <h:commandLink value="Delete" action="#{jSFManagedBean.delete(item)}" onclick="return confirm('Are you sure?')"></h:commandLink>
            </h:column>
                </h:dataTable>
            </h:form>
-------------------------------------------------------------
insert
---------------------------
 <h:form>
            name:<h:inputText value="#{jSFManagedBean.name}"></h:inputText><br/>
            brand:<h:inputText value="#{jSFManagedBean.brandname}"></h:inputText><br/>
            
            <h:selectOneMenu value="#{jSFManagedBean.cid}">
                <f:selectItems value="#{jSFManagedBean.categorylist}" var="c" itemValue="#{c.cid}" itemLabel="#{c.cname}">
                </f:selectItems>
            </h:selectOneMenu>
            <h:commandButton value="save" action="#{jSFManagedBean.add()}"></h:commandButton>
        </h:form>
-----------------------------------
edit
-------------------------------------------
<h:form>
            name:<h:inputText value="#{jSFManagedBean.name}"></h:inputText><br/>
            brand:<h:inputText value="#{jSFManagedBean.brandname}"></h:inputText><br/>
            
            <h:selectOneMenu value="#{jSFManagedBean.cid}">
                <f:selectItems value="#{jSFManagedBean.categorylist}" var="c" itemValue="#{c.cid}" itemLabel="#{c.cname}">
                </f:selectItems>
            </h:selectOneMenu>
            <h:commandButton value="save" action="#{jSFManagedBean.edit()}"></h:commandButton>
        </h:form>
---------------------------------------------------------------------
index
----------------------------------------------
<h:form>
                <h1><h:outputText value="List"/></h1>
                <h:dataTable value="#{jSFManagedBean.findAll()}" var="item">
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Pid"/>
                        </f:facet>
                        <h:outputText value="#{item.pid}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Pname"/>
                        </f:facet>
                        <h:outputText value="#{item.pname}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Brandname"/>
                        </f:facet>
                        <h:outputText value="#{item.brandname}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Cid"/>
                        </f:facet>
                        <h:outputText value="#{item.cid}"/>
                    </h:column>
                </h:dataTable>
            </h:form>
============================================================================================
===================================2 TABLE CRUD WITH JSF============================================

prepare database ,coonection bridge,insert driver,persistant unit,entity,ejbs,managed Bean (right click+new+other+jsf CDI Bean,inside that scope application )(addinser code+callenterprise bean+select your ejvlocal+okay)
change persistant unit name start the server
for rest(right click on project->restful web services from patterns) next,next,okay
then put all bean method in that remove inside logic and call all localbean methods also add uperlines like get post etc
and then create restfull java client
=============================================================================================
persistent.xml
-----------------------------------------------------------------
<persistence-unit name="Jsf_MultipalTable_crudPU" transaction-type="JTA">
    <jta-data-source>jdbc/mscit</jta-data-source>
   
    <properties/>
--------------------------------------------------------------------------
--------------------------------------EJB----------------------------------------
customerLocal.java

----------------------

// ====  Customer =========
    Collection<Customer> getAllCustomers();
     //==== Address =================
     
     void addAddresOfCustomer(String street, String city, String state, String zip, Integer custId);
     void updateAddresOfCustomer(Integer addressId,String street, String city, String state, String zip, Integer custId);
     void removeAddressOfCustomer(Integer addressId, Integer custId);
     Collection<Address> getAddresesOfCustomer(Integer custId);
     Collection<Address> getAddressesByCity(String city);
     Collection<Address> getAddressesByState(String state);
     Collection<Address> getAddressesByZip(String zip);
     Collection<Address> getAddresses(String city, String State);
--------------------------------------------------------------------------------
customer.java
---------------------------
@Stateless
public class customer implements customerLocal {
 @PersistenceContext(unitName = "Jsf_MultipalTable_crudPU")
    EntityManager em;
    @Override
    public Collection<Customer> getAllCustomers() {
       return em.createNamedQuery("Customer.findAll").getResultList();
    }

    @Override
    public void addAddresOfCustomer(String street, String city, String state, String zip, Integer custId) {
Customer c = em.find(Customer.class, custId);
    Collection<Address> addresses = c.getAddressCollection();
    
    Address address = new Address();
    address.setStreet(street);
    address.setCity(city);
    address.setState(state);
    address.setZip(zip);
    address.setCustomerId(c); // Very Important
    
    addresses.add(address);
    c.setAddressCollection(addresses);
    
    em.persist(address);
    em.merge(c);
        }

    @Override
    public void updateAddresOfCustomer(Integer addressId, String street, String city, String state, String zip, Integer custId) {
         Address a=em.find(Address.class,addressId);
         Customer c = em.find(Customer.class, custId);
    
//         a.setAddressId(addressId);
         a.setState(state);
          a.setCity(city);
          a.setStreet(street);
          a.setZip(zip);
         a.setCustomerId(c);
         
       em.merge(a);
    }

    @Override
    public void removeAddressOfCustomer(Integer addressId, Integer custId) {
Customer c = em.find(Customer.class, custId);
    Address address = em.find(Address.class, addressId);
    
    Collection<Address> addresses = c.getAddressCollection();
    
    if(addresses.contains(address))
    {
        addresses.remove(address);
        c.setAddressCollection(addresses);
        em.remove(address);
        em.merge(c);
    }
        }

    @Override
    public Collection<Address> getAddresesOfCustomer(Integer custId) {
Customer c = em.find(Customer.class, custId);
    
   return c.getAddressCollection();
    }

    @Override
    public Collection<Address> getAddressesByCity(String city) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public Collection<Address> getAddressesByState(String state) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public Collection<Address> getAddressesByZip(String zip) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public Collection<Address> getAddresses(String city, String State) {
           return em.createNamedQuery("Address.findAll").getResultList();

    }

    // Add business logic below. (Right-click in editor and choose
    // "Insert Code > Add Business Method")
}

==============================================MANAGEDBEAN========================================

@Named(value = "managedBean")
@ApplicationScoped
public class ManagedBean {

    @EJB
    private customerLocal customer;
    
    Customer c = new Customer();
    Address a = new Address();
    
    
            
    Collection<Customer> castomer;
    private int addressId;
    private int customerId;
    private String street;
    private String city;
    private String state;
    private String zip;

    public Customer getC() {
        return c;
    }

    public void setC(Customer c) {
        this.c = c;
    }

    public Address getA() {
        return a;
    }

    public void setA(Address a) {
        this.a = a;
    }

    public Collection<Customer> getCastomer() {
        return castomer;
    }

    public void setCastomer(Collection<Customer> castomer) {
        this.castomer = castomer;
    }

    public int getAddressId() {
        return addressId;
    }

    public void setAddressId(int addressId) {
        this.addressId = addressId;
    }

    public int getCustomerId() {
        return customerId;
    }

    public void setCustomerId(int customerId) {
        this.customerId = customerId;
    }

    public String getStreet() {
        return street;
    }

    public void setStreet(String street) {
        this.street = street;
    }

    public String getCity() {
        return city;
    }

    public void setCity(String city) {
        this.city = city;
    }

    public String getState() {
        return state;
    }

    public void setState(String state) {
        this.state = state;
    }

    public String getZip() {
        return zip;
    }

    public void setZip(String zip) {
        this.zip = zip;
    }

   
    /**
     * Creates a new instance of ManagedBean
     */
    public ManagedBean() {
       
    }
      @PostConstruct
    public void init(){
        castomer = customer.getAllCustomers();
    }
    public Collection<Address> ShowAddresses(){
           return customer.getAddresses(city, state);  
    }
    
    public String addAddress(){
        customer.addAddresOfCustomer(street, city, state, zip, customerId);
        return "index";
    }
    
    public void deleteAddress(){
       customer.removeAddressOfCustomer(addressId, customerId);
    }
    
    public String edit(Address A)
    {
        this.addressId=A.getAddressId();
        this.state=A.getState();
        this.city=A.getCity();
        this.street=A.getStreet();
        this.zip=A.getZip();
        Customer c = A.getCustomerId();
        this.customerId =c.getCustomerID();
        this.a = new Address();
        return "editAddress";
        
    }
    
    public String edit()
    {
        this.customer.updateAddresOfCustomer(addressId, street, city, state, zip, customerId);
        return "index";
    }
    
    public void delete(Address add)
    {
        this.addressId = add.getAddressId();
        Customer c = add.getCustomerId();
        this.customerId = c.getCustomerID();
        this.customer.removeAddressOfCustomer(addressId, customerId);
    }
}
============================================XHTMLS==========================================
index.xhtml
------------------------------------------------------------------------
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        Hello from Facelets<f:view>

 <h:link value="Add Mobile" outcome="insertAddress"></h:link>
            <h:form>
                <h1><h:outputText value="List"/></h1>
                <h:dataTable value="#{managedBean.ShowAddresses()}" var="item">
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="AddressId"/>
                        </f:facet>
                        <h:outputText value="#{item.addressId}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Street"/>
                        </f:facet>
                        <h:outputText value="#{item.street}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="City"/>
                        </f:facet>
                        <h:outputText value="#{item.city}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="State"/>
                        </f:facet>
                        <h:outputText value="#{item.state}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="Zip"/>
                        </f:facet>
                        <h:outputText value="#{item.zip}"/>
                    </h:column>
                    <h:column>
                        <f:facet name="header">
                            <h:outputText value="CustomerId"/>
                        </f:facet>
                        <h:outputText value="#{item.customerId.firstName}"/>
                    </h:column>
                    <h:column>
                    <f:facet name="header">Option</f:facet>
                    <h:commandLink action="#{managedBean.delete(item)}" value="Delete"></h:commandLink>
                </h:column>
                <h:column>
                    <f:facet name="header">Option</f:facet>
                    <h:commandLink action="#{managedBean.edit(item)}" value="Edit"></h:commandLink>
                </h:column>
                </h:dataTable>
            </h:form>
        </f:view>

    </h:body>
</html>
------------------------------------------------------------------------------------------
insertAddress.xhtml
-----------------------------
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
          <h:head>
        <title>Facelet Title</title>
           </h:head>
    <h:body>

<h:form>
            state:<h:inputText value="#{managedBean.state}"></h:inputText><br/>
            city:<h:inputText value="#{managedBean.city}"></h:inputText><br/>
            street:<h:inputText value="#{managedBean.street}"></h:inputText><br/>
            zip:<h:inputText value="#{managedBean.zip}"></h:inputText><br/>
           
            <h:selectOneMenu value="#{managedBean.customerId}">
                <f:selectItems value="#{managedBean.castomer}" var="c" itemValue="#{c.customerID}" itemLabel="#{c.firstName}">
                </f:selectItems>
            </h:selectOneMenu>
            <h:commandButton value="save" action="#{managedBean.addAddress()}"></h:commandButton>
        </h:form>
    
    </h:body>
</html>

-------------------------------------------------------------------------------------
editAddress.xhtml
------------------------------------
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        Hello from Facelets
        <h:form>
            state:<h:inputText value="#{managedBean.state}"></h:inputText><br/>
            city:<h:inputText value="#{managedBean.city}"></h:inputText><br/>
            street:<h:inputText value="#{managedBean.street}"></h:inputText><br/>
            zip:<h:inputText value="#{managedBean.zip}"></h:inputText><br/>
           
            <h:selectOneMenu value="#{managedBean.customerId}">
                <f:selectItems value="#{managedBean.castomer}" var="c" itemValue="#{c.customerID}" itemLabel="#{c.firstName}">
                </f:selectItems>
            </h:selectOneMenu>
            <h:commandButton value="save" action="#{managedBean.edit()}"></h:commandButton>
        </h:form>
        

    </h:body>
</html>




==============================================================================================================================
============================================1 table JSF CRUD===============================
-----------------------------------------------------------------
UserLocal.java
------------------------------------
@Local
public interface userLocal {
     public void AddUser(Integer UserName,String FirstName,String LastName);
     void updateUser(Integer UserId,Integer UserName, String FirstName, String LastName);
    void removeUser(Integer UserId);
    public Collection<User> getUser();
}
-------------------------------------------------------
user.java(ejb)
--------------------------------
@Stateless
public class user implements userLocal {
@PersistenceContext(unitName = "JSF_RegistrationPU")
    EntityManager em;

    @Override
    public void AddUser(Integer UserName, String FirstName, String LastName) {
        User d = new User();
        d.setFirstName(FirstName);
        d.setLastName(LastName);
        d.setUserName(UserName);
        em.persist(d);
        System.out.println("Data Inserted !!");
       }

    @Override
    public Collection<User> getUser() {
       return em.createNamedQuery("User.findAll").getResultList();
    }

    @Override
    public void removeUser(Integer UserId) {
       User c = (User) em.find(User.class, UserId);
       em.remove(c);  
    }

    @Override
    public void updateUser(Integer UserId, Integer UserName, String FirstName, String LastName) {
        User u= em.find(User.class,UserId);
       u.setFirstName(FirstName);
      u.setLastName(LastName);
      u.setUserName(UserName);
   
      
      em.merge(u);     }
  
}
-----------------------------------------------------------
Managed Bean.java
---------------------------------------------
@Named(value = "index1")
@ApplicationScoped
public class UserKruti {

    @EJB
    private userLocal user1;
        
        User user=new User();
        
private Integer userID;
        private String firstName;
        private String lastName;
        private int userName;

    public Integer getUserID() {
        return userID;
    }

    public void setUserID(Integer userID) {
        this.userID = userID;
    }

    public String getFirstName() {
        return firstName;
    }

    public void setFirstName(String firstName) {
        this.firstName = firstName;
    }

    public String getLastName() {
        return lastName;
    }

    public void setLastName(String lastName) {
        this.lastName = lastName;
    }

    public int getUserName() {
        return userName;
    }

    public void setUserName(int userName) {
        this.userName = userName;
    }
    /**
     * Creates a new instance of UserKruti
     */
    public UserKruti() {
        
    }
    
    public List<User> findAll(){
      //  return (List<Departmenttb>) dataBean.getAllDepartments();
      return (List<User>) this.user1.getUser();
    }
    public String insertUser()
    {
        user1.AddUser(userName,firstName,lastName);
        return "Display";
        //Move to the "Display" Page!!
    }
    public void removeUser(User u){
       this.userID = u.getUserID();
       user1.removeUser(userID);
    }

    public String edit(User u)
    {
        this.user=u;
        this.userID=u.getUserID();
       this.userName=u.getUserName();
        this.firstName=u.getFirstName();
        this.lastName=u.getLastName();
        return "Update";    
    }
    
    public String edit()
    {
        user1.updateUser(userID, userName, firstName, lastName);
        return "Display";
        
    }
}
-----------------------------------------------------XHTML---------------------------------------------------
index.xhtml
------------------------------
<h:form>
    User Name:<h:inputText value="#{index1.userName}" maxlength="5"></h:inputText><br/>
    First Name:<h:inputText value="#{index1.firstName}"></h:inputText><br/>
    Last Name:<h:inputText value="#{index1.lastName}"></h:inputText><br/>
    
    
             Email Address:
          <h:inputText label="Email Address"
                       id="email" value="mailid" required="true"
                       requiredMessage="Please enter your email address."
		validatorMessage="Invalid email format">
          <f:validateRegex
		pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
          </h:inputText>
          <h:message for="email" style="color: red"/>


<!--            <h:selectOneMenu value="#{mobile.cid}">
                <f:selectItems value="#{mobile.categorylist}" var="c" itemValue="#{c.cid}" itemLabel="#{c.cname}">
                </f:selectItems>
            </h:selectOneMenu>-->
    <h:commandButton value="save" action="#{index1.insertUser()}"></h:commandButton>
        </h:form>
-----------------------------------------
Display.xhtml
---------------------
   <h:form>
            <h:link value="Add Mobile" outcome="index"></h:link>
            <h:dataTable var="m" value="#{index1.findAll()}" border="1">
                <h:link value="Add Mobile" outcome="index"></h:link>
                <h:column>
                    <f:facet name="header">UserName</f:facet>
                    <h:outputText value="#{m.userName}"></h:outputText>
                </h:column>
                <h:column>
                    <f:facet name="header">First Name</f:facet>
                    <h:outputText value="#{m.firstName}"></h:outputText>
                </h:column>
                <h:column>
                    <f:facet name="header">Last Name</f:facet>
                    <h:outputText value="#{m.lastName}"></h:outputText>
                </h:column>
                 <h:column>
                    <f:facet name="header">Option</f:facet>
                    <h:commandLink action="#{index1.edit(m)}" value="Edit"></h:commandLink>
                </h:column>
                <h:column>
                    <f:facet name="header">Option</f:facet>
                    <h:commandLink action="#{index1.removeUser(m)}" value="Delete"></h:commandLink>
                </h:column>
                
            </h:dataTable>
        </h:form>
-----------------------------------------
Update.xhtml
-----------------------
  <h:form>
        
           User name:<h:inputText value="#{index1.userName}"></h:inputText><br/>
           First name:<h:inputText value="#{index1.firstName}"></h:inputText><br/>
           Last name:<h:inputText value="#{index1.lastName}"></h:inputText><br/>
        
<!--        <h:selectOneMenu value="#{mobile.cid}">
            <f:selectItems value="#{mobile.categorylist}" var="c" itemValue="#{c.cid}" itemLabel="#{c.cname}">
                </f:selectItems>
            </h:selectOneMenu><br/>-->
           <h:commandButton value="save" action="#{index1.edit()}"></h:commandButton>
        </h:form>
===============================================================================================

QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ


=====================================PUBLISHING APP========================================
ejb(local.java)
--------------------------------------
@Local
public interface PublishBeanLocal {
    
    // ====  Customer =========
    Collection<Customer> getAllCustomers();
    void addCustomer(String firstName, String lastName);
    void updateCustomer(Integer custId, String firstName, String lastName);
    void removeCustomer(Integer custId);
    Collection<Customer> getCustomerByFirstName(String fname);
     Collection<Customer> getCustomerByLastName(String lname);
     Customer getCustomerById(Integer custId);
     
     //==== Address =================
     
     void addAddresOfCustomer(String street, String city, String state, String zip, Integer custId);
     void updateAddresOfCustomer(Integer addressId,String street, String city, String state, String zip, Integer custId);
     void removeAddressOfCustomer(Integer addressId, Integer custId);
     Collection<Address> getAddresesOfCustomer(Integer custId);
     Collection<Address> getAddressesByCity(String city);
     Collection<Address> getAddressesByState(String state);
     Collection<Address> getAddressesByZip(String zip);
     Collection<Address> getAddresses(String city, String State);
     
     //=============  Subscription ======
     
     void addSubscription(String title, String type);
     void updateSubscription(Integer subId, String title, String type);
     void removeSubscription(Integer subId);
     Collection<Subscription> getSubscriptionsOfCustomer(Integer custId);
     Collection<Subscription> getSubscriptionsByType(String type);
     Collection<Customer> getCustomersOfSubscription(Integer subId);
     void addSubscriptionsToCustomer(Integer custId, Collection<Integer> subIds);
      void removeSubscriptionsOfCustomer(Integer custId, Collection<Integer> subIds);
--------------------------------------------------------------------------
ejb(publishbean.java)
----------------------------------------
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ejb;

import entity.Address;
import entity.Customer;
import entity.Subscription;
import java.util.Collection;
import javax.ejb.Stateless;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

@Stateless
public class PublishBean implements PublishBeanLocal {
    
    @PersistenceContext(unitName = "PublishingAppPU")
    EntityManager em;

    @Override
    public Collection<Customer> getAllCustomers() {
       // throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
   
       return em.createNamedQuery("Customer.findAll").getResultList();
    
    }

    @Override
    public void addCustomer(String firstName, String lastName) {
    //    throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        Customer c = new Customer(firstName, lastName);
        em.persist(c);
    
    }

    @Override
    public void updateCustomer(Integer custId, String firstName, String lastName) {
       Customer u= em.find(Customer.class,custId);
       u.setCustomerID(custId);
       u.setFirstName(firstName);
      u.setLastName(lastName);
     
      
      em.merge(u);
    }

    @Override
    public void removeCustomer(Integer custId) {
      //  throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
       Customer c = (Customer) em.find(Customer.class, custId);
       em.remove(c);
    }

    @Override
    public Collection<Customer> getCustomerByFirstName(String fname) {
     //   throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
     Collection<Customer> customers = em.createNamedQuery("Customer.findByFirstName")
             .setParameter("firstName", fname)
             .getResultList();
     
     return customers;
    
    }

    @Override
    public Collection<Customer> getCustomerByLastName(String lname) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public Customer getCustomerById(Integer custId) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        return em.find(Customer.class, custId);
    }

    @Override
    public void addAddresOfCustomer(String street, String city, String state, String zip, Integer custId) {
     //   throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
    Customer c = em.find(Customer.class, custId);
    Collection<Address> addresses = c.getAddressCollection();
    
    Address address = new Address();
    address.setStreet(street);
    address.setCity(city);
    address.setState(state);
    address.setZip(zip);
    address.setCustomer(c); // Very Important
    
    addresses.add(address);
    c.setAddressCollection(addresses);
    
    em.persist(address);
    em.merge(c);
    }

    @Override
    public void updateAddresOfCustomer(Integer addressId, String street, String city, String state, String zip, Integer custId) {
 Address a=em.find(Address.class,addressId);
         Customer c = em.find(Customer.class, custId);
    
        a.setAddressId(addressId);
         a.setState(state);
          a.setCity(city);
          a.setStreet(street);
          a.setZip(zip);
         a.setCustomer(c);
         
       em.merge(a);
    }

    @Override
    public void removeAddressOfCustomer(Integer addressId, Integer custId) {
     //   throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    Customer c = em.find(Customer.class, custId);
    Address address = em.find(Address.class, addressId);
    
    Collection<Address> addresses = c.getAddressCollection();
    
    if(addresses.contains(address))
    {
        addresses.remove(address);
        c.setAddressCollection(addresses);
        em.remove(address);
        em.merge(c);
    }
    }

    @Override
    public Collection<Address> getAddresesOfCustomer(Integer custId) {
       // throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
   Customer c = em.find(Customer.class, custId);
    
   return c.getAddressCollection();
    }

    @Override
    public Collection<Address> getAddressesByCity(String city) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public Collection<Address> getAddressesByState(String state) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public Collection<Address> getAddressesByZip(String zip) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public Collection<Address> getAddresses(String city, String State) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public void addSubscription(String title, String type) {
       // throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
       Subscription s = new Subscription();
       s.setTitle(title);
       s.setType(type);
       em.persist(s);
    
    }

    @Override
    public void updateSubscription(Integer subId, String title, String type) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public void removeSubscription(Integer subId) {
     //   throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    Subscription s = em.find(Subscription.class, subId);
    em.remove(s);
    }

    @Override
    public Collection<Subscription> getSubscriptionsOfCustomer(Integer custId) {
    //    throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
     Customer c = em.find(Customer.class, custId);
    return c.getSubscriptionCollection();
    }

    @Override
    public Collection<Subscription> getSubscriptionsByType(String type) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }

    @Override
    public Collection<Customer> getCustomersOfSubscription(Integer subId) {
       // throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
   Subscription s = em.find(Subscription.class, subId);
    return s.getCustomerCollection();
    }

    @Override
    public void addSubscriptionsToCustomer(Integer custId, Collection<Integer> subIds) {
      //  throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    Customer c = (Customer) em.find(Customer.class, custId);
    Collection<Subscription> subscriptions = c.getSubscriptionCollection();
    
    for(Integer sid : subIds)
    {
        Subscription sub = (Subscription) em.find(Subscription.class, sid);
        
        if(!subscriptions.contains(sub))
        {
            Collection<Customer> customers = sub.getCustomerCollection();
            customers.add(c);
            subscriptions.add(sub);
            c.setSubscriptionCollection(subscriptions);
            sub.setCustomerCollection(customers);
            
            em.merge(c);
        }
        
    }
    
    
    }

    @Override
    public void removeSubscriptionsOfCustomer(Integer custId, Collection<Integer> subIds) {
      //  throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
     Customer c = (Customer) em.find(Customer.class, custId);
    Collection<Subscription> subscriptions = c.getSubscriptionCollection();
    
    for(Integer sid : subIds)
    {
        Subscription sub = (Subscription) em.find(Subscription.class, sid);
        
        if(subscriptions.contains(sub))
        {
            Collection<Customer> customers = sub.getCustomerCollection();
            customers.remove(c);
            subscriptions.remove(sub);
            c.setSubscriptionCollection(subscriptions);
            sub.setCustomerCollection(customers);
            
            em.merge(c);
        }
        
    }

    // Add business logic below. (Right-click in editor and choose
    // "Insert Code > Add Business Method")
    }


}
--------------------------------------------------------------------
PublishServlet.java
-----------------------------------------

package servlets;

import ejb.PublishBeanLocal;
import entity.Address;
import entity.Customer;
import entity.Subscription;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.ArrayList;
import java.util.Collection;
import javax.ejb.EJB;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet(name = "PublishServlet", urlPatterns = {"/PublishServlet"})
public class PublishServlet extends HttpServlet {

    @EJB PublishBeanLocal pbl;
   
    protected void processRequest(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType("text/html;charset=UTF-8");
        try (PrintWriter out = response.getWriter()) {
            /* TODO output your page here. You may use following sample code. */
            out.println("<!DOCTYPE html>");
            out.println("<html>");
            out.println("<head>");
            out.println("<title>Servlet PublishServlet</title>");            
            out.println("</head>");
            out.println("<body><h2>");
            
            pbl.addCustomer("Vikram", "Sampat");
                        pbl.addCustomer("Vikram1", "Sampat1");

           pbl.removeCustomer(19);
pbl.updateCustomer(20, "firstName"," lastName");
           pbl.addAddresOfCustomer("A-213", "Surat","Gujarat", "395001", 1);
//           pbl.addAddresOfCustomer("S-1", "Vadodara","Gujarat", "381006", 28);
//         pbl.removeAddressOfCustomer(21, 28);
        pbl.removeAddressOfCustomer(22, 28);
        pbl.removeCustomer(28);
          Collection sids = new ArrayList<Integer>();
          sids.add(1);
          sids.add(3);
          sids.add(4);
          
        //  pbl.addSubscriptionsToCustomer(28, sids);
         // pbl.removeSubscriptionsOfCustomer(28, sids);
          
          
          Collection<Customer> customers = pbl.getAllCustomers();
            
            for(Customer c : customers)
            {
             out.println("<br/>custId : "+ c.getCustomerID() + " Name : " + c.getFirstName()+" "+ c.getLastName());
             
//             Collection<Address> addresses = pbl.getAddresesOfCustomer(c.getCustomerID());
//             
//             for(Address a : addresses)
//             {
//                  out.println("<br/>AddressId : "+ a.getAddressId() + " Street : "+ a.getStreet()+ " City : " + a.getCity()+"  State : "+ a.getState());
//             
//             }
//             
//             Collection<Subscription> subscriptions = pbl.getSubscriptionsOfCustomer(c.getCustomerID());
//          
//             for(Subscription s : subscriptions)
//             {
//                 out.println("<br/>Subs Id : "+ s.getSubscriptionId() + " Title : "+ s.getTitle()+ " Type : "+ s.getType());
//             }
             
             out.println("<hr/>");
                
                
            }
            out.println("</h2>");
            out.println("<h1>Servlet PublishServlet at " + request.getContextPath() + "</h1>");
            out.println("</body>");
            out.println("</html>");
        }
    }
}




----------------------------------------------------2TABLE,3 table UPDATE,Remove-----------------------------------
ejb(Bean.java)


//    =======================================Places=======================================
    @Override
    public Collection<Places> getAllPlaces() {
         return em.createNamedQuery("Places.findAll").getResultList();
    }

    @Override
    public void addPlaces(Integer CategoryID, String PlaceName, Integer StateID, String Description) {
        Category c = em.find(Category.class, CategoryID);
        State s=em.find(State.class,StateID);
       if(c != null && s != null)
      {
          Collection<Places> p = c.getPlacesCollection();
          Collection<Places> p1 = s.getPlacesCollection();
           Places places = new Places();
            places.setCategoryID(c);
             places.setPlaceName(PlaceName);
             places.setStateID(s);
             places.setDescription(Description);
             em.persist(places);
             em.merge(c);
             em.merge(s);
     }
     
    
    }

    @Override
    public void updatePlaces(Integer PlaceID, Integer CategoryID, String PlaceName, Integer StateID, String Description) {
          //Packages p= em.find(Packages.class,PackageID);
         Places p = em.find(Places.class, PlaceID);
         Category c = em.find(Category.class, CategoryID);
         State s =em.find(State.class, StateID);
         p.setCategoryID(c);
         p.setPlaceName(PlaceName);
         p.setStateID(s);
         p.setDescription(Description);
       em.merge(p);
    }

    @Override
    public void removePlaces(Integer PlaceID) {
        Places p = em.find(Places.class, PlaceID);
        em.remove(p);
    }

    @Override
    public Collection<Places> SerchPlaces(String pname) {
        Collection<Places> places = em.createNamedQuery("Places.findByPlaceName")
             .setParameter("placeName", pname)
             .getResultList();
     
     return places;
    }
-------------------------------------
servlet
----------------------
@EJB AdminBeanLocal pbl;

       //Collection<Places> place = pbl.getAllPlaces();
              //Collection<Places> place = pbl.SerchPlaces("Dwarika");
              //for(Places p : place )
              //{
               //   out.println("<br/>Placename : "+p.getPlaceName()+ " Description : " + p.getDescription());
              //}
              //pbl.addPlaces(1,"Dwarika",1,"Lord Krishna");
              // pbl.addPlaces(1,"Somnath",1,"Lord Krishna");
              //pbl.addPlaces(1,"sdas",1,"sadasds");
               //pbl.updatePlaces(1,1,"DWARIKA",1,"MY Krishna");
               //pbl.removePlaces(3);
               
====================================================REST=======================================
--------------------------------------------------------------------------------------------------
restPublishResource.java(restful web service from pattern)
--------------------------------------

package rest;

import ejb.PublishBeanLocal;
import entity.Address;
import entity.Customer;
import entity.Subscription;
import java.util.Collection;
import javax.ejb.EJB;
import javax.ws.rs.Consumes;
import javax.ws.rs.DELETE;
import javax.ws.rs.GET;
import javax.ws.rs.POST;
import javax.ws.rs.core.Context;
import javax.ws.rs.core.UriInfo;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;

@Path("publish")
public class RestPublishResource {
    
    @EJB PublishBeanLocal pbl;

    @Context
    private UriInfo context;

    public RestPublishResource() {
    }

   @GET
   @Produces(MediaType.APPLICATION_JSON)
    public Collection<Customer> getAllCustomers() {
       // throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
   
       return pbl.getAllCustomers();
    
    }

    @Path("addcustomer/{fname}/{lname}")
    @POST
    public void addCustomer(@PathParam("fname") String firstName, @PathParam("lname") String lastName) {
    pbl.addCustomer(firstName, lastName);
    }
 
    @Path("remcust/{id}")
    @DELETE
    public void removeCustomer(@PathParam("id") Integer custId) {
      pbl.removeCustomer(custId);
    }

    @Path("getcustbyfname/{fname}")
    @GET
    @Produces(MediaType.APPLICATION_JSON)
    public Collection<Customer> getCustomerByFirstName(@PathParam("fname") String fname) {
     
     return pbl.getCustomerByFirstName(fname);
    
    }

    @Path("getcustbyid/{id}")
    @GET
    @Produces(MediaType.APPLICATION_JSON)
    public Customer getCustomerById(@PathParam("id") Integer custId) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        return pbl.getCustomerById(custId);
    }

    @Path("addaddress/{street}/{city}/{state}/{zip}/{id}")
    @POST   
    public void addAddresOfCustomer(@PathParam("street") String street, @PathParam("city") String city, @PathParam("state") String state, @PathParam("zip") String zip, @PathParam("id") Integer custId) {
     
    pbl.addAddresOfCustomer(street, city, state, zip, custId);
    }
    @Path("remaddress/{aid}/{cid}")
    @DELETE
    public void removeAddressOfCustomer(@PathParam("aid") Integer addressId,@PathParam("cid") Integer custId) {
    
    pbl.removeAddressOfCustomer(addressId, custId);
    }

    @Path("getaddressofcust/{id}")
    @GET
    @Produces(MediaType.APPLICATION_JSON)  
    public Collection<Address> getAddresesOfCustomer(@PathParam("id") Integer custId) {
    
   return pbl.getAddresesOfCustomer(custId);
    }

    @Path("addsubs/{title}/{type}")
    @POST
    public void addSubscription(@PathParam("title") String title, @PathParam("type") String type) {
      pbl.addSubscription(title, type);
    }

   @Path("remsubs/{id}")
    @DELETE    
    public void removeSubscription(@PathParam("id") Integer subId) {
    pbl.removeSubscription(subId);
    }

    @Path("getsubsofcust/{id}")
    @GET
    @Produces(MediaType.APPLICATION_JSON)
    public Collection<Subscription> getSubscriptionsOfCustomer(@PathParam("id") Integer custId) {
    
    return pbl.getSubscriptionsOfCustomer(custId);
    }
  
    @Path("getcustsofsub/{id}")
    @GET
    @Produces(MediaType.APPLICATION_JSON)
    public Collection<Customer> getCustomersOfSubscription(@PathParam("id") Integer subId) {
       
    return pbl.getCustomersOfSubscription(subId);
    }

    @Path("addsubsofcust/{id}")
    @POST    
    @Consumes(MediaType.APPLICATION_JSON)
    public void addSubscriptionsToCustomer(@PathParam("id") Integer custId, Collection<Integer> subIds) {
      
        pbl.addSubscriptionsToCustomer(custId, subIds);
    }
    @Path("remsubsofcust/{id}")
    @POST    
    @Consumes(MediaType.APPLICATION_JSON)
    public void removeSubscriptionsOfCustomer(@PathParam("id") Integer custId, Collection<Integer> subIds) {
      pbl.removeSubscriptionsOfCustomer(custId, subIds);
    }
}
----------------------------------------------
restClient.jav(by clicking new + restful java client)
---------------------------------------------


------------------------------
SERVLET
----------------------------------

package servlets;

import RestRadhikaCLient.restRadhikaClient;
import client.RestPublishClient;
import entity.Address;
import entity.Customer;
import entity.Subscription;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.ArrayList;
import java.util.Collection;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.ws.rs.core.GenericType;
import javax.ws.rs.core.Response;

@WebServlet(name = "RestPublishServlet", urlPatterns = {"/RestPublishServlet"})
public class RestPublishServlet extends HttpServlet {
    
    Response res;
    //Response res1;
    RestPublishClient  pbl;
    //restRadhikaClient pbl1;
    Collection<Customer> customers;
    GenericType<Collection<Customer>> gcustomers;
    Collection<Address> addresses;
    GenericType<Collection<Address>> gaddresses;
    Collection<Subscription> subscriptions;
    GenericType<Collection<Subscription>> gsubscriptions;

    protected void processRequest(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType("text/html;charset=UTF-8");
        try (PrintWriter out = response.getWriter()) {
            /* TODO output your page here. You may use following sample code. */
            out.println("<!DOCTYPE html>");
            out.println("<html>");
            out.println("<head>");
            out.println("<title>Servlet RestPublishServlet</title>");            
            out.println("</head>");
            out.println("<body>");
            out.println("<h1>Servlet RestPublishServlet at " + request.getContextPath() + "</h1>");
            out.println("<body><h3>");
            
            pbl =  new RestPublishClient();
             //pbl1 =  new restRadhikaClient();
             
            gcustomers= new GenericType<Collection<Customer>>(){};
             gaddresses= new GenericType<Collection<Address>>(){};
            gsubscriptions= new GenericType<Collection<Subscription>>(){};
           
            
           // pbl.addCustomer("Vikram", "Sampat");
           
        //   pbl.addAddresOfCustomer("A-213", "Surat","Gujarat", "395001", "29");
        //    pbl.addAddresOfCustomer("S-1", "Vadodara","Gujarat", "381006", "29");
        // pbl.removeAddressOfCustomer("23", "29");
        // pbl.removeAddressOfCustomer("24", "29");
        //pbl1.removeCustomer("2");
          Collection sids = new ArrayList<Integer>();
          sids.add(1);
          sids.add(3);
          sids.add(4);
          
         // pbl.addSubscriptionsToCustomer(sids,"29");
          //pbl.removeSubscriptionsOfCustomer(sids, "29");
          
          
         res = pbl.getAllCustomers(Response.class);
        // res1 = pbl1.getAllCustomers(Response.class);
//         Collection<Customer> customers1 = res1.readEntity(gcustomers);
//            
//            for(Customer c : customers1)
//            {
//             out.println("custId of radhika : "+ c.getCustomerID() + " Name : " + c.getFirstName()+" "+ c.getLastName());
//             
          Collection<Customer> customers = res.readEntity(gcustomers);
            
            for(Customer c : customers)
            {
             out.println("custId : "+ c.getCustomerID() + " Name : " + c.getFirstName()+" "+ c.getLastName());
             
             
             res = pbl.getAddresesOfCustomer(Response.class,c.getCustomerID().toString());
             Collection<Address> addresses = res.readEntity(gaddresses);
             
             for(Address a : addresses)
             {
                  out.println("<br/>AddressId : "+ a.getAddressId() + " Street : "+ a.getStreet()+ " City : " + a.getCity()+"  State : "+ a.getState());
             
             }
             res = pbl.getSubscriptionsOfCustomer(Response.class, c.getCustomerID().toString());
             Collection<Subscription> subscriptions = res.readEntity(gsubscriptions);
          
             for(Subscription s : subscriptions)
             {
                 out.println("<br/>Subs Id : "+ s.getSubscriptionId() + " Title : "+ s.getTitle()+ " Type : "+ s.getType());
             }
             out.println("<hr/>");
            }
            out.println("</h3>");
            out.println("</html>");
        }
    }
}
============================================================================================


QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ


=========================================MOBILE CRUD WITH JSF===============================

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ejb;

import entity.Categorytb;
import entity.Mobiletb;
import java.util.Collection;
import javax.ejb.EJB;
import javax.ejb.Stateless;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

/**
 *
 * @author De
 */
@Stateless
public class DataBean implements DataBeanLocal {

    @PersistenceContext(unitName="TestApp-ejbPU")
    EntityManager em;
    
    @Override
    public Collection<Categorytb> getAllCategories() {
//        throw new5 UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
        return em.createNamedQuery("Categorytb.findAll").getResultList();
    }

    @Override
    public void addCategory(String cname) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
        Categorytb c = new Categorytb();
        c.setCname(cname);
        em.persist(c);
    }

    @Override
    public void updateCategory(Integer cid, String cname) {
    //    throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
        Categorytb c = em.find(Categorytb.class,cid);
        c.setCname(cname);
        em.merge(c);
    }

    @Override
    public void removeCategory(Integer cid) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
        Categorytb c = em.find(Categorytb.class,cid);
        em.remove(c);
    }

    @Override
    public Collection<Mobiletb> getAllMobiles() {
        return em.createNamedQuery("Mobiletb.findAll").getResultList();
    }

    @Override
    public void addMobile(String name, String camera, String myear, String Size, String memory, Integer cid, String company) {
        
        Categorytb c  = em.find(Categorytb.class,cid);
        Mobiletb mobile = new Mobiletb();
        mobile.setName(name);
        mobile.setCamera(camera);
        mobile.setCompany(company);
        mobile.setMemory(memory);
        mobile.setSize(Size);
        mobile.setYear(myear);
        mobile.setCid(c);
        
        em.persist(mobile);
        
        Collection<Mobiletb> categories = c.getMobiletbCollection();
        
        categories.add(mobile);
        c.setMobiletbCollection(categories);
        em.merge(c);
    }

    @Override
    public void updateMobile(Integer modelno, String name, String camera, String year, String Size, String memory, Integer cid, String company) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
        
        Categorytb c = em.find(Categorytb.class,cid);
        Mobiletb m = em.find(Mobiletb.class,modelno);
        
        m.setCamera(camera);
        m.setCompany(company);
        m.setMemory(memory);
        m.setName(name);
        m.setSize(Size);
        m.setYear(year);
        m.setCid(c);
        
        em.merge(m);
        
    }

    @Override
    public void removeMobile(Integer modelno, Integer cid) {
        
        Categorytb c = em.find(Categorytb.class, cid);
        Mobiletb m = em.find(Mobiletb.class, modelno);
        
        Collection<Mobiletb> category = c.getMobiletbCollection();
        
        if(category.contains(m)){
            category.remove(m);
            c.setMobiletbCollection(category);
            em.remove(m);
            em.merge(c);
        }
    }

    // Add business logic below. (Right-click in editor and choose
    // "Insert Code > Add Business Method")
}


CDIBEAN

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package Controller;

import static com.sun.faces.facelets.util.Path.context;
import ejb.DataBeanLocal;
import entity.Categorytb;
import entity.Mobiletb;
import java.util.Collection;
import javax.annotation.PostConstruct;
import javax.ejb.EJB;
import javax.inject.Named;
import javax.enterprise.context.ApplicationScoped;
import javax.faces.application.FacesMessage;
import javax.faces.component.UIInput;
import javax.faces.validator.ValidatorException;

/**
 *
 * @author De
 */
@Named(value = "mobile")
@ApplicationScoped
public class Mobile {

    @EJB
    private DataBeanLocal dataBean;


    Mobiletb mobile = new Mobiletb();
    Categorytb category = new Categorytb();
    
    private int modelno,cid;
    private String name,camera,year,size,memory,company;
            
    Collection<Categorytb> categorylist;
    
    public int getModelno() {
        return modelno;
    }

    public void setModelno(int modelno) {
        this.modelno = modelno;
    }

    public int getCid() {
        return cid;
    }

    public void setCid(int cid) {
        this.cid = cid;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getCamera() {
        return camera;
    }

    public void setCamera(String camera) {
        this.camera = camera;
    }

    public String getYear() {
        return year;
    }

    public void setYear(String year) {
        this.year = year;
    }

    public String getSize() {
        return size;
    }

    public void setSize(String size) {
        this.size = size;
    }

    public String getMemory() {
        return memory;
    }

    public void setMemory(String memory) {
        this.memory = memory;
    }

    public String getCompany() {
        return company;
    }

    public void setCompany(String company) {
        this.company = company;
    }

    public Collection<Categorytb> getCategorylist() {
        return categorylist;
    }

    public void setCategorylist(Collection<Categorytb> categorylist) {
        this.categorylist = categorylist;
    }
            
    public Mobile() {
    }
    
    @PostConstruct
    public void init(){
        categorylist = dataBean.getAllCategories();
    }
             
    public Collection<Mobiletb> showAll(){
        return dataBean.getAllMobiles();
    }
    
    public String add(){
        dataBean.addMobile(name, camera, year, size, memory, cid, company);
        return "displaymobile";
    }
    
    public void delete(){
        dataBean.removeMobile(modelno,cid);
    }
    
    public String edit(Mobiletb m)
    {
        this.modelno = m.getModelno();
        this.camera = m.getCamera();
        this.company = m.getCompany();
        this.memory = m.getMemory();
        this.size = m.getSize();
        this.year = m.getYear();
        this.name = m.getName();
        Categorytb c = m.getCid();
        this.cid = c.getCid();
        this.mobile = new Mobiletb();
        return "editmobile";
    }
    
    public String edit()
    {
        this.dataBean.updateMobile(modelno, name, camera, year, size, memory, cid, company);
        return "displaymobile";
    }
    
    public void delete(Mobiletb m)
    {
        this.modelno = m.getModelno();
        Categorytb c = m.getCid();
        this.cid = c.getCid();
        this.dataBean.removeMobile(modelno, cid);
    }
}

Display
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        <h:form>
            <h:link value="Add Mobile" outcome="insertmobile"></h:link>
            <h:dataTable var="m" value="#{mobile.showAll()}" border="1">
                <h:link value="Add Mobile" outcome="insertmobile"></h:link>
                <h:column>
                    <f:facet name="header">Model No</f:facet>
                    <h:outputText value="#{m.modelno}"></h:outputText>
                </h:column>
                <h:column>
                    <f:facet name="header">Name</f:facet>
                    <h:outputText value="#{m.name}"></h:outputText>
                </h:column>
                <h:column>
                    <f:facet name="header">Camera</f:facet>
                    <h:outputText value="#{m.camera}"></h:outputText>
                </h:column>
                <h:column>
                    <f:facet name="header">Company</f:facet>
                    <h:outputText value="#{m.company}"></h:outputText>
                </h:column>
                <h:column>
                    <f:facet name="header">Memory</f:facet>
                    <h:outputText value="#{m.memory}"></h:outputText>
                </h:column>
                <h:column>
                    <f:facet name="header">Size</f:facet>
                    <h:outputText value="#{m.size}"></h:outputText>
                </h:column>
                <h:column>
                    <f:facet name="header">year</f:facet>
                    <h:outputText value="#{m.year}"></h:outputText>
                </h:column>
                <h:column>
                    <f:facet name="header">Category name</f:facet>
                    <h:outputText value="#{m.cid.cname}"></h:outputText>
                </h:column>
                <h:column>
                    <f:facet name="header">Option</f:facet>
                    <h:commandLink action="#{mobile.delete(m)}" value="Delete"></h:commandLink>
                </h:column>
                <h:column>
                    <f:facet name="header">Option</f:facet>
                    <h:commandLink action="#{mobile.edit(m)}" value="Edit"></h:commandLink>
                </h:column>
                
            </h:dataTable>
        </h:form>
    </h:body>
</html>


insertmobile
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        <h:form>
            Name:<h:inputText value="#{mobile.name}"></h:inputText><br/>
            Camera:<h:inputText value="#{mobile.camera}"></h:inputText><br/>
            Company:<h:inputText value="#{mobile.company}"></h:inputText><br/>
            Memory:<h:inputText value="#{mobile.memory}"></h:inputText><br/>
            Size:<h:inputText value="#{mobile.size}"></h:inputText><br/>
            Year:<h:inputText value="#{mobile.year}"></h:inputText><br/>
            <h:selectOneMenu value="#{mobile.cid}">
                <f:selectItems value="#{mobile.categorylist}" var="c" itemValue="#{c.cid}" itemLabel="#{c.cname}">
                </f:selectItems>
            </h:selectOneMenu>
            <h:commandButton value="save" action="#{mobile.add()}"></h:commandButton>
        </h:form>
    </h:body>
</html>

editmobile
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        <h:form>
        Model no:<h:inputText value="#{mobile.modelno}"></h:inputText><br/>
        Model name:<h:inputText value="#{mobile.name}"></h:inputText><br/>
        Model camera:<h:inputText value="#{mobile.camera}"></h:inputText><br/>
        Model company:<h:inputText value="#{mobile.company}"></h:inputText><br/>
        Model memory:<h:inputText value="#{mobile.memory}"></h:inputText><br/>
        Model size:<h:inputText value="#{mobile.size}"></h:inputText><br/>
        Model year:<h:inputText value="#{mobile.year}"></h:inputText><br/>
        <h:selectOneMenu value="#{mobile.cid}">
            <f:selectItems value="#{mobile.categorylist}" var="c" itemValue="#{c.cid}" itemLabel="#{c.cname}">
                </f:selectItems>
            </h:selectOneMenu><br/>
        <h:commandButton value="save" action="#{mobile.edit()}"></h:commandButton>
        </h:form>
    </h:body>
</html>

==========================================================================================
QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ
======================================FILTER WITH JSF=====================================


/entity/Department.java			(Add the named query)
========================================================

@NamedQuery(name = "Department.findByDeptNames", query = "SELECT d FROM Department d WHERE d.deptName IN :deptNames")

========================================================
/beans/EmpBean.java				(Add this function with code)
========================================================
@Override
    public Collection<Employee> getEmpByDeptNames(Collection<String> deptNames) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    
        
        Collection<Department> depts=em.createNamedQuery("Department.findByDeptNames")
                .setParameter("deptNames", deptNames)
                .getResultList();
        
        Collection<Employee> emps=new ArrayList<Employee>();
        
        for(Department d:depts){
            emps.addAll(d.getEmployeeCollection());
        }
        return emps;
    }

===============================================
/ManagedBean/EmployeeBean
===============================================

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package managedBeans;

import beans.EmpBeanLocal;
import entity.Department;
import entity.Employee;
import entity.Project;
import java.util.ArrayList;
import java.util.Collection;
import java.util.List;
import javax.annotation.PostConstruct;
import javax.ejb.EJB;
import javax.ejb.Init;
import javax.inject.Named;
import javax.enterprise.context.ApplicationScoped;
import javax.validation.constraints.Min;
import javax.validation.constraints.Size;

/**
 *
 * @author kruti
 */
@Named(value = "employeeBean")
@ApplicationScoped
public class EmployeeBean {

    ///URL Not changing after edit, it should be reflect in url like "Display.xhtml"
    @EJB
    private EmpBeanLocal empBean;

    Employee emp=new Employee();
    Department dept=new Department();
    
    private Integer empId;
    
    private String fname;
    private String lname;
    
    //@Size(max=2, message = "Age must contain 2 digit number")  
    @Min(18)
    private int age;
    private int salary;
    private Integer deptId;
    
    //private Department dept;
    private Collection<Department> departments;
    private Collection<Project> projectCollection;
    private Collection<String> deptNms;
    
    public EmployeeBean() {
    }

    @PostConstruct          //IMPORTANT
    public void init(){
        this.departments=empBean.getAllDepartments();
        this.deptNms=new ArrayList<String>();
    }

    public Collection<String> getDeptNms() {
        return deptNms;
    }

    public void setDeptNms(Collection<String> deptNms) {
        this.deptNms = deptNms;
    }

    
    public Integer getEmpId() {
        return empId;
    }

    public void setEmpId(Integer empId) {
        this.empId = empId;
    }

    public String getFname() {
        return fname;
    }

    public void setFname(String fname) {
        this.fname = fname;
    }

    public String getLname() {
        return lname;
    }

    public void setLname(String lname) {
        this.lname = lname;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }

    public int getSalary() {
        return salary;
    }

    public void setSalary(int salary) {
        this.salary = salary;
    }

    public Integer getDeptId() {
        return deptId;
    }

    public void setDeptId(Integer deptId) {
        this.deptId = deptId;
    }

    public Collection<Project> getProjectCollection() {
        return projectCollection;
    }

    public void setProjectCollection(Collection<Project> projectCollection) {
        this.projectCollection = projectCollection;
    }

    public Department getDept() {
        return dept;
    }

    public void setDept(Department dept) {
        this.dept = dept;
    }
    
    public List<Employee> findAll(){
        
        if(deptNms.isEmpty()){
            
            return (List<Employee>) this.empBean.getAllEmployees();
        }else{
            
            return (List<Employee>) this.empBean.getEmpByDeptNames(deptNms);
        }
    
    }
    
    public String addEmployee(){
        
        empBean.addEmployee(fname, lname, age, salary, deptId);
        
        return "display";
    }
    
    public String edit(Employee e){
        this.emp=e;
        this.empId=e.getEmpId();
        this.dept=e.getDept();
        this.fname=e.getFname();
        this.lname=e.getLname();
        this.age=e.getAge();
        this.salary=e.getSalary();
        this.deptId=e.getDept().getDeptId();
        
        return "Edit";
    }

    public Collection<Department> getDepartments() {
        return departments;
    }

    public void setDepartments(Collection<Department> departments) {
        this.departments = departments;
    }
    
    
    
    public String edit(){
        
        empBean.updateEmployee(empId, fname, lname, age, salary, deptId);
        this.emp=null;
        this.empId=0;
        this.dept=null;
        this.fname="";
        this.lname="";
        this.age=0;
        this.salary=0;
        this.deptId=0;
        return "display";
    }
    
    public void deleteEmp(Integer id){
        empBean.deleteEmployee(id);
    }
}

========================================================
display.xhtml
========================================================

<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
     >
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        <center>
            <h:form>
                <br/>
                <h:link value="Add Employee" outcome="Insert"></h:link>
                
                <br/><br/>
                
                <h:selectManyCheckbox id="deptSel" value="#{employeeBean.deptNms}">
                    <f:ajax event="click" execute="deptSel" render="tb1" />
                    <f:selectItems value="#{employeeBean.departments}" var="d" itemValue="#{d.deptName}" itemLabel="#{d.deptName}">
                        
                    </f:selectItems>
                </h:selectManyCheckbox>
                
                
                <br/><br/>
        <h:dataTable id="tb1" var="e" value="#{employeeBean.findAll()}" border="1" cellpadding="1" width="500" cellspacing="1">
            <h:column>
                <f:facet name="header">Name</f:facet>
                <h:outputText value="#{e.fname} #{e.lname}"></h:outputText>
            </h:column>
            
            <h:column>
                <f:facet name="header">Age</f:facet>
                <h:outputText value="#{e.age}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Salary</f:facet>
                <h:outputText value="#{e.salary}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Department</f:facet>
                <h:outputText value="#{e.dept.deptName}"></h:outputText>
            </h:column>
            <h:column>
                <f:facet name="header">Edit</f:facet>
                <h:commandLink value="Edit" action="#{employeeBean.edit(e)}"></h:commandLink>
            </h:column>
            <h:column>
                <f:facet name="header">Delete</f:facet>
                <h:commandLink value="Delete" action="#{employeeBean.deleteEmp(e.empId)}" onclick="return confirm('Are you sure?')"></h:commandLink>
            </h:column>
        </h:dataTable>
            </h:form>
        </center>
    </h:body>
</html>
==========================================================================================
QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ
 require="true";
maxlength="5";

VALIDATION EMAIL


Email Address:
          <h:inputText label="Email Address"
                       id="email" value="mailid" required="true"
                       requiredMessage="Please enter your email address."
		validatorMessage="Invalid email format">
          <f:validateRegex
		pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)(\.[A-Za-z]{2,})$" />
          </h:inputText>
          <h:message for="email" style="color: red"/>
========================================================================================

for getting redymade from and datatable in jsf

steps----------------------------

toolbar + window + IDE tools + Pallete
----------------
drag and drop
































==============================================End rrrrrr====================================

